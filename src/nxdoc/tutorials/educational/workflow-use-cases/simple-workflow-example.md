---
title: Simple Workflow Example
review:
    comment: ''
    date: '2017-01-24'
    status: ok
labels:
    - lts2016-ok
    - excerpt
toc: true
tree_item_index: 100
history:
    -
        author: Manon Lumeau
        date: '2016-01-18 16:06'
        message: 'eplace "Write" by "Edit"  '
        version: '50'
    -
        author: Manon Lumeau
        date: '2015-11-06 14:51'
        message: ''
        version: '49'
    -
        author: Manon Lumeau
        date: '2015-09-16 08:58'
        message: ''
        version: '48'
    -
        author: Manon Lumeau
        date: '2015-09-16 08:57'
        message: Reverted from v. 45
        version: '47'
    -
        author: Manon Lumeau
        date: '2015-09-16 08:57'
        message: ''
        version: '46'
    -
        author: Manon Lumeau
        date: '2015-09-16 08:56'
        message: ''
        version: '45'
    -
        author: Manon Lumeau
        date: '2015-02-26 15:08'
        message: ''
        version: '44'
    -
        author: Manon Lumeau
        date: '2015-02-26 14:49'
        message: ''
        version: '43'
    -
        author: Manon Lumeau
        date: '2015-02-26 14:48'
        message: ''
        version: '42'
    -
        author: Manon Lumeau
        date: '2015-02-26 14:02'
        message: ''
        version: '41'
    -
        author: Manon Lumeau
        date: '2015-02-26 13:51'
        message: ''
        version: '40'
    -
        author: Manon Lumeau
        date: '2015-02-26 13:13'
        message: ''
        version: '39'
    -
        author: Manon Lumeau
        date: '2015-02-26 11:13'
        message: ''
        version: '38'
    -
        author: Manon Lumeau
        date: '2015-02-26 10:52'
        message: ''
        version: '37'
    -
        author: Manon Lumeau
        date: '2015-02-26 10:40'
        message: ''
        version: '36'
    -
        author: Manon Lumeau
        date: '2015-02-26 09:46'
        message: ''
        version: '35'
    -
        author: Manon Lumeau
        date: '2015-02-25 17:34'
        message: ''
        version: '34'
    -
        author: Manon Lumeau
        date: '2015-02-25 17:19'
        message: ''
        version: '33'
    -
        author: Manon Lumeau
        date: '2015-02-25 17:16'
        message: ''
        version: '32'
    -
        author: Manon Lumeau
        date: '2015-02-25 16:21'
        message: ''
        version: '31'
    -
        author: Manon Lumeau
        date: '2015-02-25 16:06'
        message: ''
        version: '30'
    -
        author: Manon Lumeau
        date: '2015-02-25 14:49'
        message: ''
        version: '29'
    -
        author: Manon Lumeau
        date: '2015-02-25 14:46'
        message: ''
        version: '28'
    -
        author: Manon Lumeau
        date: '2015-02-25 14:10'
        message: ''
        version: '27'
    -
        author: Manon Lumeau
        date: '2015-02-25 14:09'
        message: ''
        version: '26'
    -
        author: Manon Lumeau
        date: '2015-02-25 13:55'
        message: ''
        version: '25'
    -
        author: Manon Lumeau
        date: '2014-12-10 16:36'
        message: ''
        version: '24'
    -
        author: Harlan Brown
        date: '2013-10-03 17:42'
        message: ''
        version: '23'
    -
        author: Harlan Brown
        date: '2013-10-03 16:24'
        message: ''
        version: '22'
    -
        author: Solen Guitter
        date: '2013-09-11 12:26'
        message: ''
        version: '21'
    -
        author: Solen Guitter
        date: '2013-09-11 12:25'
        message: Updated screenshots
        version: '20'
    -
        author: Solen Guitter
        date: '2013-09-11 12:17'
        message: ''
        version: '19'
    -
        author: Solen Guitter
        date: '2013-09-09 18:49'
        message: ''
        version: '18'
    -
        author: Alain Escaffre
        date: '2013-05-06 01:28'
        message: ''
        version: '17'
    -
        author: Alain Escaffre
        date: '2013-05-06 01:28'
        message: ''
        version: '16'
    -
        author: Bertrand Chauvin (perso)
        date: '2013-04-30 15:12'
        message: Formatting tentative
        version: '15'
    -
        author: Bertrand Chauvin (perso)
        date: '2013-04-30 14:51'
        message: Added pre requisites
        version: '14'
    -
        author: Bertrand Chauvin (perso)
        date: '2013-04-30 14:44'
        message: ''
        version: '13'
    -
        author: Bertrand Chauvin (perso)
        date: '2013-04-30 14:36'
        message: ''
        version: '12'
    -
        author: Bertrand Chauvin (perso)
        date: '2013-04-30 14:36'
        message: ''
        version: '11'
    -
        author: Bertrand Chauvin (perso)
        date: '2013-04-30 14:33'
        message: ''
        version: '10'
    -
        author: Bertrand Chauvin (perso)
        date: '2013-04-30 14:30'
        message: ''
        version: '9'
    -
        author: Bertrand Chauvin (perso)
        date: '2013-04-29 18:01'
        message: ''
        version: '8'
    -
        author: Bertrand Chauvin (perso)
        date: '2013-04-29 17:59'
        message: ''
        version: '7'
    -
        author: Bertrand Chauvin (perso)
        date: '2013-04-29 17:59'
        message: ''
        version: '6'
    -
        author: Bertrand Chauvin (perso)
        date: '2013-04-29 17:11'
        message: Headings definition
        version: '5'
    -
        author: Bertrand Chauvin (perso)
        date: '2013-04-27 16:39'
        message: Formatting
        version: '4'
    -
        author: Bertrand Chauvin (perso)
        date: '2013-04-27 16:31'
        message: Formatting
        version: '3'
    -
        author: Bertrand Chauvin (perso)
        date: '2013-04-26 16:48'
        message: Copy from my initial word document
        version: '2'
    -
        author: Alain Escaffre
        date: '2013-04-23 19:08'
        message: ''
        version: '1'
---

## Use Case

{{! excerpt}}
Company C has decided to be more rigorous on proposals sent by the sales team. A workflow has to be set up so that each proposal is reviewed by the head of operations, this one being able to decide of an additional juridical control.
{{! /excerpt}}

The graph we want is like this:

![](https://www.lucidchart.com/publicSegments/view/54edd493-2438-46d6-8c71-742e0a00c1d3/image.png?w=500)

## Prerequisites

The following operations have to be done in your Nuxeo Platform before following this tutorial:

- Create a user having for id "Jack".
- Give Jack read and edit access on the domain.
- Create a user group having for id "Internal_Lawyers".
- Populate the "Internal_Lawyers" group with at least one user.
- Create the user that will launch the workflow.

## Implementation Steps

### Creating the Workflow

1.  In the Workflow category, click on **Process definitions**.
2.  Click on the **New** button.
3.  Give the workflow an id ("`SalesProposalWorkflow`"), a label and a description.
    ![]({{file name='Simple_Workflow_000.png'}} ?w=450,border=true)
4.  Click on the **Ok** button.

### Defining the Workflow's Availability

Workflows can be launched through a drop down list on the summary screen of every document. Into the &ldquo;Activation&rdquo; tab, you can decide for which type of document the workflow you do will be usable, for which group of users, etc.

1.  From the workflow, click on the **Activation** tab.
2.  In the "Current document has one of the types", select **File**.
    ![]({{file name='Simple_Workflow_002.png'}} ?w=450,h=407,border=true)

### Starting the Graph

A workflow must start with a node for which the "start node" property is checked and have at least one end node with the "end node" property checked. To make it simpler, Studio provides a node template library (on the left), from which a Start node and an Stop node are available.

To start the workflow graph:

1.  Click on the **Graph** tab.
2. By default, Studio adds the Start and Stop nodes automatically. If not,  drag and drop the Start node on the graph.
    ![](https://www.lucidchart.com/publicSegments/view/54ede03e-bcb8-4715-a9f3-1f500a008a99/image.png ?w=250,border=true)

### Defining the Technical Validation Step

Let's create and configure the technical validation step.

#### Adding the Technical Validation Node

This node will create a task for the head of operations, named "Jack". Jack will have to accept or reject the proposal submitted by the salesman, or decide that it requires a juridical advice.

Drag the **Accept/Reject** node template from the node template library and drop it on the graph.
It will already have some of the needed transitions and buttons pre-configured: &ldquo;Validate&rdquo; and &ldquo;Reject&rdquo;. You actually need another transition (&ldquo;Need juridical advice&rdquo;), which you will add manually in a future step.
![]({{file name='Simple_Workflow_003.png'}} ?w=400,border=true)

#### Configuring the Technical Validation Node

1.  Hover on the **Accept/Reject** node you just dropped and click on the **Edit** icon ![]({{file name='editor_area.gif' space='studio' page='studio-icons-index'}}) that appears to open the node properties.
    ![]({{file name='Simple_Workflow_005.png'}} ?w=150,border=true,thumbnail=true)
2.  In the **General** tab, rename the title &ldquo;Accept/Reject&rdquo; by "Technical validation" and add `CurrentDate.days(5)` in front of the Due date expression.
    ![]({{file name='technical-validation-general.png'}} ?w=450,border=true)
3.  Add a statical assignee ("Jack"): Click on the "Add" link in front of the "Assignees" field. Add the "Assignees expression" `NodeVariables["assignees"]`.
    We will leave aside the &ldquo;Grant permission to task assignees&rdquo; field blank.
    ![]({{file name='technical-validation-assignee.png'}} ?w=450,border=true)
4.  Click on the **Save** button of the popup.
5.  Click on the **Save** button of the workflow feature on the bottom left corner.

### Configuring the Workflow Variables

During this task, we want to capture the head of operations' comment. We could use a node variable, but using a workflow variable is more appropriate as it will let us leverage the head of operations' comment value in the other nodes. For example, to display it to the other users in their own task validation form, so as to know what was the option of the head of operations when taking the decision. Getting the juridical advisor and salesman's comment will be needed at a later stage, so we will add workflow variables for their comments as well.

This variable will be named &ldquo;hoo_comment&rdquo;.

**To add the workflow variables:**

1.  Click on the **Variables** tab of the workflow.
2.  Add the head of operation's comment variable and name it `hoo_comment`. It is like editing a schema.
3.  Add the juridical advisor's comment variable: `juridical_comment`.
4.  Add the salesman's comment variable: `sales_comment`.
    ![]({{file name='Simple_Workflow_004.png'}} ?w=600,border=true)
5.  Click on **Save**.

### Configuring the Technical Validation step forms and actions

The form lets the user edit some of the workflow's variables (either at workflow level or node level), and the buttons help the engine to know which transition to play after the node, depending on what the user clicked on.

#### Configuring the Form

1.  Go back to the &ldquo;Technical validation&rdquo; node.
2. Click on the **Variables** tab.
   Add the hoo_comment to the right collumn.
   ![]({{file name='Simple_Workflow_006_1.png'}} ?w=600,border=true)
3.  Click on the **Form** tab.
    A form like the one to edit a document's layout is displayed.
4.  Add a field for the comment of the user who validates: Drag the &ldquo;hoo_comment&rdquo; field from the workflow variables schema and drop it on the layout.
5.  Edit the widget, the same way you edit the form of a document:
    *   Change its title for "Head of operations comment".
    *   Select the widget type "Textarea".
    ![]({{file name='technical-validation-textarea.png'}} ?w=600,border=true)

#### Setting up the Tasks Buttons

The buttons that are shown on the form are configured on the **Resolution Actions** tab. Two are already available because of the template node you chose. You need to add a third one when the document requires juridical expertise.

1.  Click on **Add task button**.
2.  Fill in the button id and label.
3.  Let the box "Generate the condition for the transition" checked.
 ![]({{file name='Simple_Workflow_008_1.png'}} ?w=450,h=316, border=true)

#### Check the Transitions

Each button is automatically associated to a transition to define what should be done when the user clicks on the button. Transitions automatically get a condition, which is a system node variable called &ldquo;button&rdquo;. This variable is systematically updated with the id of the button used to process the task. It is useful to configure the behavior of the transitions.

1.  Finally, click on the **Transition** tab.
    Note that you could add more terms in the condition if necessary.
    ![]({{file name='technical-validation-transitions.png'}} ?w=450,border=true)
2.  Click on **Save**.

#### Connecting the Nodes

1.  Go back to the graph.
2.  Link the Start node to the Technical validation node, by pulling an arrow between the unique transition point of the Start node to the input point of the Technical validation node.
    Note that you have three transition points on the technical validation node, ready to be pulled to the next nodes.
    ![]({{file name='Simple_Workflow_012.png'}} ?w=200,border=true,thumbnail=true)

### Defining the "Juridical Advice" Node

Now that we have our &ldquo;Technical validation&rdquo; node set up, we need to create the nodes used for its possible transitions. First comes the &ldquo;Juridical advice&rdquo; node. As most operations have been described before, we will only comment this node&rsquo;s specificities.

#### Adding the Node

Drag the &ldquo;Approve&rdquo; node from the node template library and drop it on the graph.

![](https://www.lucidchart.com/publicSegments/view/54eefcaf-64e8-42a2-ad51-6ed50a00c10c/image.png ?w=300,border=true)

#### Configuring the "Juridical Advice" Node

1.  Open the node properties.
2.  Rename the node to &ldquo;Juridical advice&rdquo;.
3.  Define the assignees.
    This time we would like to ask a member of the &ldquo;Internal_ Lawyers&rdquo; user group to comment instead of a specific person. Therefore, instead of adding a specific username, you may simply add an assignee and use the prefix &ldquo;group:&rdquo; to specify a user group. In this case, we will set the value to &ldquo;`group:Internal_Lawyers`&rdquo; and add the "Assignees expression" &ldquo;`NodeVariables["assignees"]`&rdquo;.
4.  Grant the appropriate rights.
    The internal lawyers may not have the necessary rights to read and/or edit a sales proposal document. To avoid an exception to be thrown because of this, you need to grant them the appropriate rights on the document that needs juridical advice temporarily. This is what the &ldquo;Grant permission to task assignees&rdquo; field is used for. In this case, choose the &ldquo;Read & Edit&rdquo; permission to let them modify the document. Keep in mind that these rights will only be granted during the operations made on this node, and reverted to their previous state when following a transition to another node.

    ![]({{file name='juridical-advice-general.png'}} ?w=450,border=true)

#### Configuring the Form

1. Click on the **Variables** tab and add the "juridical_comment" and "hoo_comment" variables to the right column.
  ![]({{file name='Simple_Workflow_015_1.png'}} ?w=600,border=true)
2.  Click on the **Form** tab.
3.  Add the &ldquo;juridical_comment&rdquo; field the same way you did with the &ldquo;Technical validation&rdquo; node.
    ![]({{file name='juridical-comment.png'}} ?w=450,border=true)
4.  Add the &ldquo;hoo_comment&rdquo; as well, but make sure to set it as read only.
    ![]({{file name='hoo-comment.png'}} ?w=450,border=true)
5.  Click on **Save**.
    ![]({{file name='juridical-advice-form.png'}}?w=450,border=true)

#### Connecting the Nodes

1.  Go back on the graph.
2.  Search for the technical validation node&rsquo;s juridical advice requirement output point.
3.  Pull an arrow from there to the juridical advice node&rsquo;s input point.
    ![]({{file name='Simple_Workflow_018.png'}} ?w=200,border=true,thumbnail=true)

### Defining the "Proposal Update" Node

You will now take care of the &ldquo;Proposal update&rdquo; node, which will be used in case Jack refuses the proposal.

#### Adding the Node

The &ldquo;Approve&rdquo; node will once again be the most appropriate. Pick it up and drop it on the graph.

#### Configuring the "Proposal Update" Node

1.  Open the node properties.
2.  Rename the node to &ldquo;Proposal update&rdquo;.
3.  Rename the directive: In the &ldquo;Directive&rdquo; field, replace &ldquo;Acknowledgement&rdquo; by &ldquo;Proposal update&rdquo;.
4.  Define the Due date expression: `CurrentDate.days(5)`
5.  Define the assignees.
    Here comes another interesting situation: this task may not be assigned to a particular person, neither may it be assigned to a group. It needs to be assigned to the document's creator. To do so, a variable needs to be used instead of a hard coded value. The "Assignees" field may only receive usernames or groups, not variables.
    We will rather use the &ldquo;Assignees expression&rdquo; field and set this variable as value: &ldquo;`@{Document["dc:creator"]}`&rdquo;. This will return the document creator's username.
    Note that there are no specific rights to grant there as in this situation the document will be heading back to its creator.
    ![]({{file name='proposal-update-general.png'}} ?w=450,border=true)

#### Configuring the Form

1. Click on the **Variables** tab and add the "sales_comment" and "hoo_comment" variables to the right column.
    ![]({{file name='Simple_Workflow_020_1.png'}} ?w=450,border=true,thumbnail=true)
2.  Click on the **Form** tab.
3.  Add the &ldquo;sales_comment&rdquo; field as well as the &ldquo;hoo_comment&rdquo; field, the latter still in read only mode.
    ![]({{file name='Simple_Workflow_020_2.png'}} ?w=450,border=true,thumbnail=true)
4.  Rename the task.
    Calling the task an approval task could lead to confusion for the salesman that wants to submit an updated proposal. Thus, we will rename it.
    1.  Click on the **Resolution Actions** tab.
    2.  Click on the **Add task button** link.
    3.  We will use &ldquo;submit_updated_proposal&rdquo; as the task button's id and &ldquo;Submit updated proposal&rdquo; as label.    
    ![]({{file name='Simple_Workflow_022_1.png'}} ?w=450,border=true,thumbnail=true)

#### Removing the "Approve" Transition

1.  Click on the **Transitions** tab.
    As you may see, deleting the task button in the previous step does not automatically remove the transition as well. We will do it manually then.
2.  Click on the icon ![]({{file name='edit_wiz.png'}}) next to the "approve" transition and click on **Remove** in the contextual menu.
    ![]({{file name='proposal-update-transitions.png'}} ?w=450,border=true)
3.  Confirm row deletion on the popup window.
4.  Click on **Save**.

#### Connecting the Nodes

1.  Go back to the graph.
2.  Search for the technical validation node&rsquo;s reject output point.
3.  Pull an arrow from there to the proposal update node&rsquo;s input point.
4.  Make sure you connect the proposal update node&rsquo;s output point back to the technical validation node&rsquo;s input point too.
    ![]({{file name='Simple_Workflow_024.png'}} ?w=300,border=true,thumbnail=true)

### Adding the End Node

This is almost finished. The last node needed is the end node. This node sets a possible ending to the workflow. In this situation only one end node will be used, but remember that you may use several end nodes if needed.

Pickup the &ldquo;Stop&rdquo; node from the node template library and drop it on the graph.

### Automating Document's Metadata Update

A document being accepted by the head of operations or the juridical services has to see its metadata updated. This is something we can achieve through an automation chain. Let's see how we will manage this situation.

1.  Open the end node properties.
2.  Check the existing chains / Launch a new chain creation.
3.  In the **General** tab, the "Automation chains" section lets you make use of an existing automation chain, that you may even edit by using the corresponding link. Automation chains can be launched at different moments, fdepending of your needs. The input operation chain will be played when entering the node, the output chain when the node is being left. In this situation the chain needs to be played from the start, but is not existing yet though.

    1.  Click on the **Create** link of the "Input operation chain".
        ![]({{file name='empty-end-node.png'}} ?w=450,border=true)
    2.  Give an id to your chain : "`SetAsApproved`".
        ![]({{file name='Simple_Workflow_026.png'}} ?w=350,border=true)
    3.  In the editor, add the "Document > Follow Life Cycle Transition" operation using drag and drop.
        ![]({{file name='empty-automation-chain.png'}} ?w=450,border=true)

    4.  Open it and set its value to "approve".
        ![]({{file name='Simple_Workflow_028_1.png'}} ?w=450,border=true)

    5.  Save the chain and go back to your workflow graph.

    6.  Now that the chain is created, you may have a look at your end node properties.

        You will see that the input operation chain has been automatically filled in thanks to our previous operation.
        ![]({{file name='end-node-setasapproved.png'}} ?w=450,border=true)

### Connecting the Nodes

1.  Link both the technical validation node&rsquo;s accept output point **and** the juridical advice&rsquo;s outpoint to the end node.
2.  Save your work.
    Your workflow is now complete. Enjoy it!
    Below is a screenshot of what it may look like once finished.

    ![]({{file name='Simple_Workflow_031.png'}} ?w=450,border=true)
