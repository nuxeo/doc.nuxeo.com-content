---
title: Use of MVEL in Automation Chains
review:
    comment: ''
    date: '2016-12-19'
    status: ok
notes: Documentation page used on Nuxeo Studio. Check with NOS team before deleting or moving.
labels:
    - lts2016-ok
    - mvel
    - scripting
    - automation
    - fdavid
    - excerpt
    - content-review-lts2017
toc: true
confluence:
    ajs-parent-page-id: '18451738'
    ajs-parent-page-title: Automation
    ajs-space-key: NXDOC
    ajs-space-name: Nuxeo Platform Developer Documentation
    canonical: Use+of+MVEL+in+Automation+Chains
    canonical_source: 'https://doc.nuxeo.com/display/NXDOC/Use+of+MVEL+in+Automation+Chains'
    page_id: '1409169'
    shortlink: kYAV
    shortlink_source: 'https://doc.nuxeo.com/x/kYAV'
    source_link: /display/NXDOC/Use+of+MVEL+in+Automation+Chains
tree_item_index: 600
history:
    -
        author: Solen Guitter
        date: '2016-08-31 13:31'
        message: ''
        version: '90'
    -
        author: Manon Lumeau
        date: '2016-08-02 16:38'
        message: ''
        version: '89'
    -
        author: Julien Carsique
        date: '2016-02-29 10:02'
        message: MVEL_Language_Guide URL update
        version: '88'
    -
        author: Florent Guillaume
        date: '2015-10-02 12:23'
        message: ''
        version: '87'
    -
        author: Florent Guillaume
        date: '2015-10-02 12:19'
        message: Document long-existing Fn functions.
        version: '86'
    -
        author: Manon Lumeau
        date: '2015-09-16 10:20'
        message: ''
        version: '85'
    -
        author: Manon Lumeau
        date: '2014-11-03 16:22'
        message: ''
        version: '84'
    -
        author: Manon Lumeau
        date: '2014-11-03 14:47'
        message: ''
        version: '83'
    -
        author: Vincent Dutat
        date: '2014-10-23 00:25'
        message: ''
        version: '82'
    -
        author: Alain Escaffre
        date: '2014-07-22 17:16'
        message: ''
        version: '81'
    -
        author: Alain Escaffre
        date: '2014-06-12 00:12'
        message: ''
        version: '80'
    -
        author: Solen Guitter
        date: '2014-04-10 17:49'
        message: ''
        version: '79'
    -
        author: Alain Escaffre
        date: '2014-04-02 01:51'
        message: ''
        version: '78'
    -
        author: Solen Guitter
        date: '2014-01-29 17:38'
        message: ''
        version: '77'
    -
        author: Thibaud Arguillere
        date: '2014-01-29 17:30'
        message: ''
        version: '76'
    -
        author: Thibaud Arguillere
        date: '2014-01-29 13:54'
        message: ''
        version: '75'
    -
        author: Thibaud Arguillere
        date: '2014-01-28 21:08'
        message: ''
        version: '74'
    -
        author: Solen Guitter
        date: '2014-01-24 17:42'
        message: More relevant related topics
        version: '73'
    -
        author: Solen Guitter
        date: '2014-01-24 11:25'
        message: Formatting
        version: '72'
    -
        author: Solen Guitter
        date: '2014-01-17 10:15'
        message: ''
        version: '71'
    -
        author: Thibaud Arguillere
        date: '2013-12-26 18:15'
        message: ''
        version: '70'
    -
        author: Thibaud Arguillere
        date: '2013-12-26 18:12'
        message: ''
        version: '69'
    -
        author: Solen Guitter
        date: '2013-12-13 12:01'
        message: ''
        version: '68'
    -
        author: Bertrand Chauvin
        date: '2013-12-12 13:23'
        message: "Integrated Benjamin's example from the TMP page"
        version: '67'
    -
        author: Solen Guitter
        date: '2013-10-17 11:41'
        message: ''
        version: '66'
    -
        author: Vladimir Pasquier
        date: '2013-10-16 17:20'
        message: ''
        version: '65'
    -
        author: Solen Guitter
        date: '2013-09-26 16:20'
        message: ''
        version: '64'
    -
        author: Thibaud Arguillere
        date: '2013-09-26 16:16'
        message: ''
        version: '63'
    -
        author: Thibaud Arguillere
        date: '2013-09-26 15:56'
        message: ''
        version: '62'
    -
        author: Solen Guitter
        date: '2013-09-26 15:47'
        message: Removed related topics from TOC
        version: '61'
    -
        author: Florent Guillaume
        date: '2013-09-26 15:23'
        message: ''
        version: '60'
    -
        author: Solen Guitter
        date: '2013-09-26 15:20'
        message: ''
        version: '59'
    -
        author: Alain Escaffre
        date: '2013-09-26 13:55'
        message: ''
        version: '58'
    -
        author: Solen Guitter
        date: '2013-08-26 16:41'
        message: ''
        version: '57'
    -
        author: Solen Guitter
        date: '2013-08-26 16:33'
        message: typo
        version: '56'
    -
        author: Vladimir Pasquier
        date: '2013-08-14 12:34'
        message: ''
        version: '55'
    -
        author: Vladimir Pasquier
        date: '2013-08-14 12:32'
        message: ''
        version: '54'
    -
        author: Bertrand Chauvin
        date: '2013-07-11 13:47'
        message: ''
        version: '53'
    -
        author: Alain Escaffre
        date: '2013-07-11 01:34'
        message: ''
        version: '52'
    -
        author: Solen Guitter
        date: '2013-07-09 11:39'
        message: ''
        version: '51'
    -
        author: Bertrand Chauvin
        date: '2013-07-08 18:25'
        message: ''
        version: '50'
    -
        author: Bertrand Chauvin
        date: '2013-07-08 14:59'
        message: Added anchors to be used for backlinks
        version: '49'
    -
        author: Karl Harris
        date: '2013-07-03 14:40'
        message: ''
        version: '48'
    -
        author: Alain Escaffre
        date: '2013-07-01 13:49'
        message: ''
        version: '47'
    -
        author: Alain Escaffre
        date: '2013-07-01 13:49'
        message: ''
        version: '46'
    -
        author: Bertrand Chauvin
        date: '2013-06-20 13:16'
        message: Added link to general doc
        version: '45'
    -
        author: Karl Harris
        date: '2013-06-14 15:59'
        message: ''
        version: '44'
    -
        author: Karl Harris
        date: '2013-06-14 15:56'
        message: ''
        version: '43'
    -
        author: Karl Harris
        date: '2013-06-14 15:52'
        message: ''
        version: '42'
    -
        author: Bertrand Chauvin
        date: '2013-06-04 18:14'
        message: Orthography
        version: '41'
    -
        author: Alain Escaffre
        date: '2013-02-12 07:07'
        message: ''
        version: '40'
    -
        author: Alain Escaffre
        date: '2013-02-12 06:56'
        message: ''
        version: '39'
    -
        author: Alain Escaffre
        date: '2013-02-12 06:54'
        message: ''
        version: '38'
    -
        author: Benjamin Jalon
        date: '2012-03-13 10:55'
        message: Migrated to Confluence 4.0
        version: '37'
    -
        author: Benjamin Jalon
        date: '2012-03-13 10:55'
        message: Reverted from v. 34
        version: '36'
    -
        author: Benjamin Jalon
        date: '2012-03-13 10:54'
        message: ''
        version: '35'
    -
        author: Solen Guitter
        date: '2012-02-29 11:57'
        message: ''
        version: '34'
    -
        author: Alain Escaffre
        date: '2012-02-20 01:47'
        message: ''
        version: '33'
    -
        author: Alain Escaffre
        date: '2012-01-20 17:40'
        message: ''
        version: '32'
    -
        author: Alain Escaffre
        date: '2012-01-20 17:38'
        message: ''
        version: '31'
    -
        author: Alain Escaffre
        date: '2012-01-20 17:37'
        message: ''
        version: '30'
    -
        author: Solen Guitter
        date: '2011-09-12 12:34'
        message: added related howtos and tutorials
        version: '29'
    -
        author: Solen Guitter
        date: '2011-09-06 14:40'
        message: ''
        version: '28'
    -
        author: Florent Guillaume
        date: '2011-08-24 15:55'
        message: ''
        version: '27'
    -
        author: Bogdan Stefanescu
        date: '2010-08-30 19:00'
        message: ''
        version: '26'
    -
        author: Solen Guitter
        date: '2010-08-18 10:38'
        message: ''
        version: '25'
    -
        author: Stéfane Fermigier
        date: '2010-08-03 13:12'
        message: ''
        version: '24'
    -
        author: Alain Escaffre
        date: '2010-07-22 13:55'
        message: adding mvel section
        version: '23'
    -
        author: Stéfane Fermigier
        date: '2010-06-28 10:49'
        message: ''
        version: '22'
    -
        author: Stéfane Fermigier
        date: '2010-06-27 19:10'
        message: ''
        version: '21'
    -
        author: Stéfane Fermigier
        date: '2010-06-27 19:09'
        message: ''
        version: '20'
    -
        author: Bogdan Stefanescu
        date: '2010-06-21 14:58'
        message: ''
        version: '19'
    -
        author: Bogdan Stefanescu
        date: '2010-06-21 14:47'
        message: ''
        version: '18'
    -
        author: Benjamin Jalon
        date: '2010-05-31 17:28'
        message: ''
        version: '17'
    -
        author: Benjamin Jalon
        date: '2010-05-31 17:28'
        message: ''
        version: '16'
    -
        author: Alain Escaffre
        date: '2010-05-03 00:05'
        message: ''
        version: '15'
    -
        author: Solen Guitter
        date: '2010-04-30 18:35'
        message: ''
        version: '14'
    -
        author: Alain Escaffre
        date: '2010-04-26 16:52'
        message: ''
        version: '13'
    -
        author: Alain Escaffre
        date: '2010-04-26 16:49'
        message: ''
        version: '12'
    -
        author: Alain Escaffre
        date: '2010-04-26 16:48'
        message: ''
        version: '11'
    -
        author: Alain Escaffre
        date: '2010-04-26 16:47'
        message: ''
        version: '10'
    -
        author: Alain Escaffre
        date: '2010-04-26 16:46'
        message: ''
        version: '9'
    -
        author: Alain Escaffre
        date: '2010-04-26 16:28'
        message: ''
        version: '8'
    -
        author: Alain Escaffre
        date: '2010-04-26 16:08'
        message: ''
        version: '7'
    -
        author: Alain Escaffre
        date: '2010-04-26 16:03'
        message: ''
        version: '6'
    -
        author: Alain Escaffre
        date: '2010-04-26 15:59'
        message: ''
        version: '5'
    -
        author: Alain Escaffre
        date: '2010-04-26 14:51'
        message: ''
        version: '4'
    -
        author: Alain Escaffre
        date: '2010-04-26 14:47'
        message: ''
        version: '3'
    -
        author: Alain Escaffre
        date: '2010-04-26 14:25'
        message: ''
        version: '2'
    -
        author: Alain Escaffre
        date: '2010-04-23 01:23'
        message: ''
        version: '1'

---
{{#> callout type='info' }} {{! excerpt}}

This documentation focuses on the MVEL expression language, used in automation chains. For a broader look on that subject, have a look at the [Understand Expression and Scripting Languages Used in Nuxeo]({{page page='understand-expression-and-scripting-languages-used-in-nuxeo'}}) page.

{{! /excerpt}} {{/callout}}

## How to Use Scripting Features in Parameters Values

Values you put in operations parameters are provided with scripting capability.

When filling in a parameter value (like "value" parameter of "update property" in the case we want to update the title of the a document), there are three options:

*   `Title`: There is no interpretation (default behavior), the parameter is taken "as is", which means that the title will be "Title".

*   `expr:Title` starts with a "`expr:`". The system will interpret the value "Title" as a scripting expression. In that case it means that the value of the title will be updated with the content of the variable _Title_

*   `expr:The real @{Title}`: When there is the use of `@{my_variable_name}` in a script expression, the expression between bracket is considered as a variable name and resolved as a string, and the whole expression is evaluated as the concatenation of the various substrings (included the one interpreted). In our case, if the `Title` variable contains the string literal "Story", the title value will be "The real Story".

When the script is evaluated, you can use both contextual objects and embedded functions.

## Scripting Context

*   **Document**: The Document object represents the input document, when the operation takes a document as input. You can use it to get a property value of it:
    `expr:Document["dc:title"]`
    You can also use methods provided by the Document Wrapper, see below.

*   **variable_name**: If you set a context variable in a previous operation, you can access it in the parameter value by just referring to its name. In the following sample, if there was a `SetVariable` before in the operation flow that put the path of a document in the variable `path_of_the_workspace`, the parameter's value will be this path.
    `expr:path_of_the_workspace`

    {{#> callout type='note' }}

    Do not use "-" character in the variable name. Prefer the use of `_`.

    {{/callout}}

*   **Relative paths**: Each time you need to use a path expression (whether it is as a direct parameter of an operation, such as move, or in a an NXQL query, for STARTSWITH operator, you can leverage relative path capability:

    *   "." will be replaced by path of input document;
    *   ".." will be replaced by path of parent of input document.

*   **CurrentDate**: You can use the `CurrentDate` object, that will provide various utility methods to get the current date value, see below.

*   **Context.principal.model.getPropertyValue("schema:field")**: Returns the current user property. By default users implements user.xsd schema. So if you want for instance the company name, `Context.principal.model.getPropertyValue("user:company")`. But if your users implements other schemas, you choose your "schema prefix (or name if don't set) : field name"
*   **CurrentUser.actingUser**: In a workflow context, all the automation operations executed by the workflow engine are executed using a temporary unrestricted session (if the current user is not an administrator, this is a session with the user "system"). This variable allows you to fetch the current user. This can also be useful when the operation "Users and groups > Login as" has been used in order to retrieve the current username.

    {{#> callout type='info' }}

    Note that `currentUser` is an alias for `CurrentUser`.

    {{/callout}}
*   **Event:** In an event handler context, the Event object can be used to access some of the event's properties. For instance **`@{Event.getName()}`** will return the event name.

## {{> anchor 'doc-wrapper'}}Document Wrapper

The Document wrapper, used by the system for any document put in scripting context (whether under a variable name, or as the input document ("Document") provides several utility methods:

*   `Document.parent`: Returns a document wrapper of the parent of the document;

*   `Document.workspace`: Returns a document wrapper of the parent workspace of the document;

*   `Document.domain`: Returns a document wrapper of the parent domain of the document;

*   `Document.path`: Returns a string representing the value of the path of the document, like "/default-domain/workspaces/my-workspace";

*   `Document.title`: Returns the title of the document;

*   `Document.description`: Returns the description of the document;

*   `Document.type`: Returns the Nuxeo EP Document type of the document (like "File", "Folder", ...);

*   `Document.lifeCycle`: Returns the current lifecycle state of the document;

*   `Document.name`: Returns the name of the document (last part of the path);

*   `Document.versionLabel`: Returns the version name of the document (like "1.1"...).

{{#> callout type='info' }}

Note that `currentDocument` is an alias for `Document`.

{{/callout}}

{{#> callout type='info' }}
Also note that we listed here the main accessors. `Document` is a `DocumentWrapper` and you can also [check the code](https://github.com/nuxeo-archives/nuxeo-features/blob/master/nuxeo-automation/nuxeo-automation-core/src/main/java/org/nuxeo/ecm/automation/core/scripting/DocumentWrapper.java) to see all the available accessors.</br>
For example, you can also use `hasFacet(String facet)`, `hasSchema(String schemaName)`, etc. Make sure to select the branch corresponding to the version of Nuxeo you are using.
{{/callout}}

## {{> anchor 'date-wrapper'}}Date Wrapper

The Date wrapper is useful to update documents' date properties and to build time-relative NXQL queries.

- `CurrentDate.date`: returns the date. It is the method to use to update a document date field, like `dc:valid`, or whatever custom date field.

Some other methods are provided to display the current date as a string:

- `CurrentDate.format("_java formatting expression_` `")`: returns the current date in the specified format;

- `CurrentDate.time`: returns the date in milliseconds;

- `CurrentDate.day`: returns the day of the current time;

- `CurrentDate.month`: returns the month of the current time;

- `CurrentDate.year`: returns the year of the current time;

- `CurrentDate.hour`: returns the hour of the current time;

- `CurrentDate.minut`: returns the minutes of the current time;

- `CurrentDate.second`: returns the seconds of the current time;

- `CurrentDate.week`: returns the week of the current time.

Some others can be used when building an NXQL query to express dates relatively to the current date:

- `CurrentDate.days(-3)`: returns the current date minus three days;

- `CurrentDate.years(10)`: returns the current date plus ten years;

- `CurrentDate.months(-5).weeks(2).seconds(23)`: returns the current date minus five months plus two weeks and 23 seconds;

*   ...

    {{#> callout type='tip' }}

    &bull; If you want to work on a date that is held by a property of your document, you first need to get a `DateWrapper` object, by using: `@{Fn.calendar(Document["dc:created"])}`.
    Ex: `@{Fn.calendar(Document["dc:created"]).format("yyyy-MM-dd")}`

    &bull; To set a date property based on the current date, use the `CurrentDate` object, and ends the expression with the `date` wrapper. So for example, to set up the a field to

    ...today:

    `@{CurrentDate.date}`

    ...in 7 days:

    `@{CurrentDate.days(7).date}`

    &bull; To create a date that you can set on a date property from a string, you can use...

    `@{new java.text.SimpleDateFormat("yyyy-MM-dd").parse(date_str)}`

    <div>...where `date_str` is a Context variable containing a value such as "2013-09-26": You must pass to `SimpleDateFormat` the format of this date, so the parse() method will work.</div>

    {{/callout}}

## {{> anchor 'fn-object'}}Functions

The Functions object is providing a set of useful functions. This object is named `Fn` and it provides the following functions (the full list can also be checked in [the code](https://github.com/nuxeo/nuxeo/blob/master/nuxeo-features/nuxeo-automation/nuxeo-automation-features/src/main/java/org/nuxeo/ecm/automation/features/PlatformFunctions.java), make sure to select the branch of your version):

- `Fn.getNextId(String key)`: Returns a unique value for the given key using the default sequencer. Each time this function is called using the same key a different string will be returned.

- `Fn.getNextId(String key, String sequencerName)`: Same as `Fn.getNextId(String key)` but allows for using a specific sequencer.

- `Fn.getVocabularyLabel(String vocabularyName, String key)`: Returns a value from the named vocabulary that is associated with the given key.

- `Fn.getPrincipal(String userName)`: Returns a Java `NuxeoPrincipal` object for the given username string.

- `Fn.getPrincipalsFromGroup(String group)`: Returns a Java `Set` of `NuxeoPrincipal` for the given group. Also returns the subgroups.

- `Fn.getPrincipalsFromGroup(String group, boolean ignoreGroups)`: Returns a Java `Set` of `NuxeoPrincipal` for the given group. Only the users are returned, not subgroups.

- `Fn.getEmail(String userName)`: Returns the e-mail of the given username.

- `Fn.getEmails(List<String> userNames)`: Returns a list of e-mails for the given user name list.

- `Fn.getEmails(List<String> userNames, boolean usePrefix)`: Returns a list of e-mails for the given user name list. If `userPrefix` is `true`, each item is prefixed with `user:`.

- `Fn.getPrincipalEmails(List<NuxeoPrincipal> principals)`: Same as above but the input object is a list of Nuxeo principals.

- `Fn.getEmailsFromGroup(String groupName)`: Returns a list of e-mails of all the users of the group.

- `Fn.concatenateIntoList(List<T> list, Object... values)`: Adds the values to the list. If a value is itself an array or a collection, each of its members are added to the list. The list is returned.

- `Fn.concatenateValuesAsNewList(Object... values)`: Same as `concatenateIntoList` but using a newly-created list.

- `Fn.htmlEscape(String string)`: Returns an escaped version of the string suitable for HTML inclusion.

- `Fn.nxqlEscape(String string)`: Returns an escaped version of the string suitable for NXQL inclusion inside single quotes.

- `Fn.documentExists(CoreSession session, String idOrPath)`: Returns `true` if the document exists in the repository.

- `Fn.getDirService()`: Returns the `DirectoryService`. Requires administration privileges.

## Nuxeo Environment Properties

Nuxeo environment properties are accessible in scripts using the `Env` map object. All the properties defined in Nuxeo property files located in Nuxeo `conf` directory are available through the `Env` map. This is very useful when you want to configure your operations using values that can be modified later on a running server.

For example let's say you want to make an operation that is creating a document and initialize its description from a Nuxeo property named `automation.document.description`.

In order to do this you should:

1.  Fetch the property using the `Env` map in your operation parameter: `Env["automation.document.description"]`.
2.  And then on the target server to create a property file inside the Nuxeo `conf` directory that defines the variable you are using in the operation chain:
    _automation.document.description = My Description_

## MVEL

The scripting language used is MVEL. See the [MVEL language guide](https://en.wikisource.org/wiki/MVEL_Language_Guide). You can use all the features of the scripting language itself.

For instance, you can use the substring method, when dealing with paths:
`expr: Document.path.substring(26)`.

Testing if a variable is null:

```
@{WorkflowVariables["mail"] == empty?"VoidChain":"MyChain"}
```

Usage of `empty` variable allows user to evaluate expression to empty string. For instance to set a property of a document to "" (empty string), you can define the value with `empty:`

```
@{empty}
```

## Date Management Example

<div class="table-scroll"><table class="hover"><tbody><tr><th colspan="1">

Operation

</th><th colspan="1">

Destination field

</th><th colspan="1">

Source value

</th><th colspan="1">

Expression Example

</th></tr><tr><td colspan="1">

Services > Create Task

</td><td colspan="1">

due date

</td><td colspan="1">

Current Date

</td><td colspan="1">

`@{CurrentDate.date}`

</td></tr><tr><td colspan="1">

&nbsp;

</td><td colspan="1">

&nbsp;

</td><td colspan="1">

Next Month

</td><td colspan="1">

`@{CurrentDate.month(1).date}`

</td></tr><tr><td colspan="1">

&nbsp;

</td><td colspan="1">

&nbsp;

</td><td colspan="1">

Given Date

</td><td colspan="1">

2012-03-15T00:00:00Z

</td></tr><tr><td colspan="1">

&nbsp;

</td><td colspan="1">

&nbsp;

</td><td colspan="1">

Date Property from the input Document

</td><td colspan="1">

`@{Document.getProperty("dc:expired")}`

</td></tr><tr><td colspan="1">

&nbsp;

</td><td colspan="1">

&nbsp;

</td><td colspan="1">

Date Property from the input Document

</td><td colspan="1">

`@{Document.getProperty("dc:expired")}`

</td></tr><tr><td colspan="1">

Document > Update property

</td><td colspan="1">

value

</td><td colspan="1">

Current Date

</td><td colspan="1">

`@{CurrentDate.date}`

</td></tr><tr><td colspan="1">

&nbsp;

</td><td colspan="1">

&nbsp;

</td><td colspan="1">

Next Month

</td><td colspan="1">

`@{CurrentDate.month(1).date}`

</td></tr><tr><td colspan="1">

Document > Update property

</td><td colspan="1">

value

</td><td colspan="1">

Current Date

</td><td colspan="1">

`@{CurrentDate.date}`

</td></tr></tbody></table></div>

If you have an error like that in your logs:

```
No type adapter found for input: class org.nuxeo.ecm.automation.core.scripting.DateWrapper and output class java.util.Date

```

This means that you are presenting a DateWrapper value type into a field that waits for a`java.util.Date` object. |

## User and Group Management Example

<div class="table-scroll"><table class="hover"><tbody><tr><th colspan="1">

Operation

</th><th colspan="1">

Destination field

</th><th colspan="1">

Source value

</th><th colspan="1">

Expression Example

</th><th colspan="1">

Remark

</th></tr><tr><td colspan="1">

Document > Update property

</td><td colspan="1">

value

</td><td colspan="1">

String

</td><td colspan="1">

Administrator

</td><td colspan="1">

&nbsp;

</td></tr><tr><td colspan="1">

Document > Update property

</td><td colspan="1">

value

</td><td colspan="1">

Static value

</td><td colspan="1">

Current User

</td><td colspan="1">

&nbsp;

</td></tr><tr><td colspan="1">

Services > Create task

</td><td colspan="1">

additional list of actors prefixed ids

</td><td colspan="1">

String

</td><td colspan="1">

`user:Administrator`

</td><td colspan="1">

&nbsp;

</td></tr><tr><td colspan="1">

&nbsp;

</td><td colspan="1">

&nbsp;

</td><td colspan="1">

String

</td><td colspan="1">

`group:administrators`

</td><td colspan="1">

&nbsp;

</td></tr><tr><td colspan="1">

&nbsp;

</td><td colspan="1">

variable name for actors prefixed ids

</td><td colspan="1">

In Context

</td><td colspan="1">

variable

</td><td colspan="1">

This variable can be set by the "User & Group > Get Users and Groups" with "prefix identifiers" checked.

</td></tr><tr><td colspan="1">

&nbsp;

</td><td colspan="1">

&nbsp;

</td><td colspan="1">

Current User

</td><td colspan="1">

`user:@{CurrentUser.name}`

</td><td colspan="1">

&nbsp;

</td></tr><tr><td colspan="1">

User & Group > Get Users and Groups&nbsp;

</td><td colspan="1">

&nbsp;

</td><td colspan="1">

&nbsp;

</td><td colspan="1">

&nbsp;

</td><td colspan="1">

&nbsp;

</td></tr></tbody></table></div>

## Numbers Management example

<div class="table-scroll"><table class="hover"><tbody><tr><th colspan="1">

Operation

</th><th colspan="1">

Destination field

</th><th colspan="1">

Source value

</th><th colspan="1">

Expression Example

</th><th colspan="1">

Remark

</th></tr><tr><td colspan="1">

Conversion > Resize a picture

</td><td colspan="1">

maxHeight/maxWidth

</td><td colspan="1">

integer

</td><td colspan="1">

10

</td><td colspan="1">

&nbsp;

</td></tr></tbody></table></div>

## Document management example

### Field management

<div class="table-scroll"><table class="hover"><tbody><tr><th colspan="1">

Operation

</th><th colspan="1">

Destination field

</th><th colspan="1">

Source value

</th><th colspan="1">

Expression Example

</th><th colspan="1">

Remark

</th></tr><tr><td colspan="1">

Document > Copy

</td><td colspan="1">

target

</td><td colspan="1">

String

</td><td colspan="1">

`/default-domain/workspaces`

</td><td colspan="1">

Here is specified the path of the container where the document is to be created. The path is given by the names of ancestors of the document (can be different from the title and stored into a different field of the document).

</td></tr><tr><td colspan="1">

Document > Copy

</td><td colspan="1">

target

</td><td colspan="1">

from context

</td><td colspan="1">

`@{Context["documentStored"].name}`

</td><td colspan="1">

This will work if you have previously added the **Execution Context > Set Context Variable**&nbsp;into your automation chain to store the document into this `documentStored` variable.

</td></tr><tr><td colspan="1">

&nbsp;

</td><td colspan="1">

name

</td><td colspan="1">

String

</td><td colspan="1">

name-of-my-document

</td><td colspan="1">

This field is a technical one and used to create the notion of path (see above). **This is not the title**. This is also used for URL generation. Look at the URL after navigating to a document and you will see his path based on the names of the document's ancestor and its name.

</td></tr><tr><td colspan="1">

Document > Create

</td><td colspan="1">

type

</td><td colspan="1">

String

</td><td colspan="1">

File

</td><td colspan="1">

Here you must use the name of the document type (not the label).

</td></tr></tbody></table></div>

## Referencing Automation Chain Parameters

```
@{ChainParameters['parameterName']}
```

## More Advanced Scripts

In this section, we will gather useful scripts so as to share experience on using scripting in automation, especially in the Run Script operation.

{{#> panel type='code' heading='Working with a list of properties'}}

```java
new ArrayList(Arrays.asList(WorkflowVariables["contributors"])); x.add(Context["workflowInitiator"]); WorkflowVariables["contributors"]=x;
// This works for workflow variables, (NodeVariables and WorkflowVariables) but would also work for a list property of a document, see this question on answers (http://answers.nuxeo.com/questions/4240/add-string-to-a-list-string-property-in-pure-studioautomation-for-prototypes)
```

{{/panel}}{{#> panel type='code' heading='Calling a Nuxeo service'}}

```
 @{org.nuxeo.runtime.api.Framework.getService(org.nuxeo.business.days.management.service.BusinessDaysService).getLimitDate("myRule",CurrentDate.date)}
```

{{/panel}}<div class="row" data-equalizer data-equalize-on="medium"><div class="column medium-6">{{#> panel heading='Related Documentation'}}

- [Understand Expression and Scripting Languages Used in Nuxeo]({{page page='understand-expression-and-scripting-languages-used-in-nuxeo'}})
- [Automation]({{page page='automation'}})
- [Automation in Nuxeo Studio]({{page space='studio' page='automation'}})
{{/panel}}</div><div class="column medium-6"></div></div>
