---
title: CMIS
review:
    comment: ''
    date: '2018-05-21'
    status: ok
labels:
    - lts2016-ok
    - cmis
    - fguillaume
    - soap
    - blogs
    - cmis-component
    - content-review-lts2017
toc: true
confluence:
    ajs-parent-page-id: '950287'
    ajs-parent-page-title: Content Repository
    ajs-space-key: NXDOC
    ajs-space-name: Nuxeo Platform Developer Documentation
    canonical: CMIS
    canonical_source: 'https://doc.nuxeo.com/display/NXDOC/CMIS'
    page_id: '950308'
    shortlink: JIAO
    shortlink_source: 'https://doc.nuxeo.com/x/JIAO'
    source_link: /display/NXDOC/CMIS
tree_item_index: 800
history:
    -
        author: Lise Kemen
        date: '2016-10-10 08:28'
        message: ''
        version: '80'
    -
        author: Solen Guitter
        date: '2016-09-08 13:09'
        message: ''
        version: '79'
    -
        author: Solen Guitter
        date: '2016-09-08 13:04'
        message: ''
        version: '78'
    -
        author: Manon Lumeau
        date: '2016-08-02 15:18'
        message: ''
        version: '77'
    -
        author: Florent Guillaume
        date: '2016-03-29 15:56'
        message: proxies visible in CMIS
        version: '76'
    -
        author: Florent Guillaume
        date: '2015-12-09 14:58'
        message: details
        version: '75'
    -
        author: Florent Guillaume
        date: '2015-10-22 15:26'
        message: NXP-18219 AtomPub CMIS 1.0
        version: '74'
    -
        author: Florent Guillaume
        date: '2015-10-13 14:52'
        message: ''
        version: '73'
    -
        author: Solen Guitter
        date: '2015-04-09 07:36'
        message: ''
        version: '72'
    -
        author: Solen Guitter
        date: '2015-04-08 15:28'
        message: Add use case video and reorganize resources section
        version: '71'
    -
        author: Solen Guitter
        date: '2015-02-25 08:49'
        message: ''
        version: '70'
    -
        author: Manon Lumeau
        date: '2015-02-19 09:54'
        message: ''
        version: '69'
    -
        author: Manon Lumeau
        date: '2015-02-19 09:41'
        message: ''
        version: '68'
    -
        author: Manon Lumeau
        date: '2015-02-19 09:40'
        message: ''
        version: '67'
    -
        author: Manon Lumeau
        date: '2015-02-19 09:39'
        message: ''
        version: '66'
    -
        author: Manon Lumeau
        date: '2015-02-19 09:38'
        message: ''
        version: '65'
    -
        author: Manon Lumeau
        date: '2015-02-19 09:37'
        message: ''
        version: '64'
    -
        author: Manon Lumeau
        date: '2015-02-19 09:33'
        message: ''
        version: '63'
    -
        author: Manon Lumeau
        date: '2015-02-19 09:32'
        message: ''
        version: '62'
    -
        author: Manon Lumeau
        date: '2015-02-19 09:32'
        message: ''
        version: '61'
    -
        author: Manon Lumeau
        date: '2015-02-19 09:31'
        message: ''
        version: '60'
    -
        author: Florent Guillaume
        date: '2015-01-09 11:27'
        message: 'complex props, secondary types'
        version: '59'
    -
        author: Solen Guitter
        date: '2014-12-26 09:58'
        message: 'Replace demo.nuxeo.com with online trial, update URLs and format toc'
        version: '58'
    -
        author: Florent Guillaume
        date: '2014-11-04 15:16'
        message: ''
        version: '57'
    -
        author: Florent Guillaume
        date: '2014-10-14 01:59'
        message: ACLs/Joins capabilities
        version: '56'
    -
        author: Florent Guillaume
        date: '2014-10-14 01:42'
        message: ''
        version: '55'
    -
        author: Florent Guillaume
        date: '2014-10-14 01:41'
        message: 'Added nuxeo:pos'
        version: '54'
    -
        author: Florent Guillaume
        date: '2014-09-07 20:01'
        message: ''
        version: '53'
    -
        author: Florent Guillaume
        date: '2014-09-05 17:42'
        message: ''
        version: '52'
    -
        author: Solen Guitter
        date: '2014-07-23 19:01'
        message: ''
        version: '51'
    -
        author: Solen Guitter
        date: '2014-07-23 09:46'
        message: typo
        version: '50'
    -
        author: Alain Escaffre
        date: '2014-07-22 18:30'
        message: ''
        version: '49'
    -
        author: Alain Escaffre
        date: '2014-07-22 18:26'
        message: ''
        version: '48'
    -
        author: Florent Guillaume
        date: '2014-06-25 12:11'
        message: ''
        version: '47'
    -
        author: Michaël Vachette
        date: '2014-03-20 18:26'
        message: ''
        version: '46'
    -
        author: Michaël Vachette
        date: '2014-03-20 18:26'
        message: ''
        version: '45'
    -
        author: Solen Guitter
        date: '2013-09-20 18:41'
        message: ''
        version: '44'
    -
        author: Solen Guitter
        date: '2013-09-20 18:40'
        message: Removed obsolete information
        version: '43'
    -
        author: Florent Guillaume
        date: '2013-02-14 16:48'
        message: ''
        version: '42'
    -
        author: Florent Guillaume
        date: '2013-02-14 16:46'
        message: ''
        version: '41'
    -
        author: Solen Guitter
        date: '2012-09-14 11:18'
        message: Migrated to Confluence 4.0
        version: '40'
    -
        author: Solen Guitter
        date: '2012-09-14 11:18'
        message: ''
        version: '39'
    -
        author: Florent Guillaume
        date: '2012-07-02 11:52'
        message: ''
        version: '38'
    -
        author: Florent Guillaume
        date: '2012-06-20 16:11'
        message: Note that complex properties are not exposed.
        version: '37'
    -
        author: Florent Guillaume
        date: '2012-02-01 16:31'
        message: ''
        version: '36'
    -
        author: Florent Guillaume
        date: '2011-12-21 19:38'
        message: 'hg -> github'
        version: '35'
    -
        author: Florent Guillaume
        date: '2011-12-21 19:37'
        message: 'added 5.5 nuxeo:isCheckedIn and nuxeo:parentId'
        version: '34'
    -
        author: Florent Guillaume
        date: '2011-07-18 15:34'
        message: ''
        version: '33'
    -
        author: Florent Guillaume
        date: '2011-06-15 18:15'
        message: ''
        version: '32'
    -
        author: Olivier Grisel
        date: '2011-04-29 12:12'
        message: ''
        version: '31'
    -
        author: Olivier Grisel
        date: '2011-04-29 12:04'
        message: ''
        version: '30'
    -
        author: Olivier Grisel
        date: '2011-04-29 12:04'
        message: ''
        version: '29'
    -
        author: Olivier Grisel
        date: '2011-04-29 12:03'
        message: link to CMISQL from within Nuxeo
        version: '28'
    -
        author: Olivier Grisel
        date: '2011-04-29 11:58'
        message: ''
        version: '27'
    -
        author: Olivier Grisel
        date: '2011-04-27 22:43'
        message: ''
        version: '26'
    -
        author: Olivier Grisel
        date: '2011-04-27 17:16'
        message: ''
        version: '25'
    -
        author: Olivier Grisel
        date: '2011-04-27 17:14'
        message: format
        version: '24'
    -
        author: Olivier Grisel
        date: '2011-04-27 17:11'
        message: added section on nuxeo specific system properties
        version: '23'
    -
        author: Olivier Grisel
        date: '2011-04-19 15:37'
        message: ''
        version: '22'
    -
        author: Florent Guillaume
        date: '2011-04-15 11:36'
        message: ''
        version: '21'
    -
        author: Florent Guillaume
        date: '2011-04-15 11:24'
        message: ''
        version: '20'
    -
        author: Florent Guillaume
        date: '2011-03-17 17:08'
        message: ''
        version: '19'
    -
        author: Florent Guillaume
        date: '2011-03-17 17:01'
        message: "doesn't belong here"
        version: '18'
    -
        author: Florent Guillaume
        date: '2011-03-15 14:16'
        message: ''
        version: '17'
    -
        author: Julien Carsique
        date: '2011-03-04 14:30'
        message: add webengine admin url for cmis
        version: '16'
    -
        author: Florent Guillaume
        date: '2011-02-25 15:32'
        message: ''
        version: '15'
    -
        author: Florent Guillaume
        date: '2010-11-25 15:45'
        message: ''
        version: '14'
    -
        author: Florent Guillaume
        date: '2010-11-09 19:54'
        message: Updated for OpenCMIS
        version: '13'
    -
        author: Florent Guillaume
        date: '2010-10-23 15:49'
        message: ''
        version: '12'
    -
        author: Jane Zupan
        date: '2010-10-22 22:17'
        message: ''
        version: '11'
    -
        author: Florent Guillaume
        date: '2010-10-01 11:32'
        message: ''
        version: '10'
    -
        author: Stéfane Fermigier
        date: '2010-07-22 22:54'
        message: ''
        version: '9'
    -
        author: Stéfane Fermigier
        date: '2010-07-22 22:53'
        message: ''
        version: '8'
    -
        author: Stéfane Fermigier
        date: '2010-07-22 22:53'
        message: ''
        version: '7'
    -
        author: Florent Guillaume
        date: '2010-05-26 23:00'
        message: ''
        version: '6'
    -
        author: Solen Guitter
        date: '2010-05-20 18:26'
        message: formatting and typos
        version: '5'
    -
        author: Eric Barroca
        date: '2010-04-29 11:43'
        message: ''
        version: '4'
    -
        author: Eric Barroca
        date: '2010-04-29 11:42'
        message: ''
        version: '3'
    -
        author: Florent Guillaume
        date: '2010-04-28 14:49'
        message: ''
        version: '2'
    -
        author: Admin name placeholder
        date: '2010-03-01 13:36'
        message: ''
        version: '1'

---
[CMIS](https://www.oasis-open.org/committees/tc_home.php?wg_abbrev=cmis) is the OASIS specification for content management interoperability. It allows client and servers to talk together in HTTP (REST with JSON, AtomPub or SOAP) using a unified domain model. The latest published version is [CMIS 1.1](http://docs.oasis-open.org/cmis/CMIS/v1.1/CMIS-v1.1.html).

Nuxeo supports CMIS through the following modules:

- The [Apache Chemistry OpenCMIS](http://chemistry.apache.org/java/opencmis.html) library (an Apache project to which Nuxeo is a contributor), which is a general-purpose Java library allowing developers to easily write CMIS clients and servers,
-  Specific Nuxeo OpenCMIS connector bundles, allowing the Nuxeo Platform to be used as a CMIS server with the help of OpenCMIS. The CMIS connector is included in the Nuxeo Platform by default.

## Usage

The following documentation uses `http://localhost:8080/nuxeo` as the URL of the Nuxeo server but you can replace it with `http://NUXEO_SERVER/nuxeo` if you have another instance available.

You can access the different services from the following URLs:

- Browser Binding root URL: `http://localhost:8080/nuxeo/json/cmis`
- AtomPub service document: `http://localhost:8080/nuxeo/atom/cmis`
- SOAP WSDL for the repository service: `http://localhost:8080/nuxeo/webservices/cmis/RepositoryService?wsdl`

### JSON

{{#> callout type='info' }}

The Browser Binding (JSON) endpoint is recommended, as it is faster and has more features than the other two endpoints.

{{/callout}}

You can use a CMIS 1.1 Browser Binding (JSON) client and point it at `http://localhost:8080/nuxeo/json/cmis`.

If you want to check the JSON returned using the command line, this can be done using `curl` or `wget`:

```bash
curl -u Administrator:Administrator http://localhost:8080/nuxeo/json/cmis | json_pp
```

This will give you the description of the default repository:

```js
{
   "default" : {
      "cmisVersionSupported" : "1.1",
      "productName" : "Nuxeo OpenCMIS Connector",
      "productVersion" : "8.10",
      "vendorName" : "Nuxeo",
      "repositoryName" : "Nuxeo Repository default",
      "repositoryDescription" : "Nuxeo Repository default",
      "repositoryUrl" : "http://localhost:8080/nuxeo/json/cmis/default/",
      "thinClientURI" : "http://localhost:8080/nuxeo/",
      "repositoryId" : "default",
      "rootFolderId" : "fe7944e0-3d44-4abc-90d4-64e0e07c63c7",
      "rootFolderUrl" : "http://localhost:8080/nuxeo/json/cmis/default/root",
      "latestChangeLogToken" : "42",
      "capabilities" : {
         "capabilityChanges" : "objectidsonly",
         "capabilityVersionSpecificFiling" : false,
         "capabilityMultifiling" : false,
         "capabilityContentStreamUpdatability" : "pwconly",
         "capabilityQuery" : "bothcombined",
         "capabilityACL" : "manage",
         "capabilityRenditions" : "read",
         "capabilityPWCSearchable" : true,
         "capabilityOrderBy" : null,
         "capabilityPWCUpdatable" : true,
         "capabilityGetDescendants" : true,
         "capabilityUnfiling" : false,
         "capabilityAllVersionsSearchable" : true,
         "capabilityGetFolderTree" : true,
         "capabilityJoin" : "none"
         "capabilityNewTypeSettableAttributes" : { ... },
         "capabilityCreatablePropertyTypes" : {
            "canCreate" : []
         },
      },
      "aclCapabilities" : {
         "propagation" : "propagate",
         "supportedPermissions" : "repository",
         "permissionMapping" : [ ... ],
         "permissions" : [ ... ]
         ]
      },
      "changesIncomplete" : false,
      "changesOnType" : [
         "cmis:document",
         "cmis:folder"
      ],
      "principalIdAnyone" : "Everyone",
      "principalIdAnonymous" : "Guest",
      "extendedFeatures" : [
         {
            "description" : "Adds an additional DateTime format for the Browser Binding.",
            "commonName" : "Browser Binding DateTime Format",
            "versionLabel" : "1.0",
            "id" : "http://docs.oasis-open.org/ns/cmis/extension/datetimeformat",
            "url" : "https://www.oasis-open.org/committees/tc_home.php?wg_abbrev=cmis"
         }
      ]
   }
}
```

To do a query you can do:

```bash
curl -u Administrator:Administrator "http://localhost:8080/nuxeo/json/cmis/default?cmisselector=query&succinct=true&q=SELECT+cmis:objectId,+dc:title+FROM+cmis:folder+WHERE+dc:title+=+'Workspaces'" | json_pp
```

Which returns:

```js
{
   "numItems" : 1,
   "hasMoreItems" : false,
   "results" : [
      {
         "succinctProperties" : {
            "cmis:objectTypeId" : "WorkspaceRoot",
            "cmis:objectId" : "96e9e7b9-75be-4123-888d-ca89af7c8da3",
            "dc:title" : "Workspaces"
         }
      }
   ]
}

```

### AtomPub

You can use a CMIS 1.1 AtomPub client and point it at `http://localhost:8080/nuxeo/atom/cmis`.

(Since Nuxeo 7.10, a legacy CMIS 1.0 AtomPub endpoint is also available at `http://localhost:8080/nuxeo/atom/cmis10` . This is provided for old clients that cannot be upgraded.)

If you want to check the AtomPub XML returned using the command line, this can be done using `curl` or `wget`:

```bash
curl -u Administrator:Administrator http://localhost:8080/nuxeo/atom/cmis

```

To do a query you can do:

```bash
curl -u Administrator:Administrator "http://localhost:8080/nuxeo/atom/cmis/default/query?q=SELECT+cmis:objectId,+dc:title+FROM+cmis:folder+WHERE+dc:title+=+'Workspaces'&searchAllVersions=true"

```

You should probably pipe this through `tidy` if you want a readable output:

```bash
... | tidy -q -xml -indent -wrap 999

```

**Notes**

- The `searchAllVersions=true` part is mandatory if you want something equivalent to what you see in Nuxeo (which often contains mostly private working copies).
- In order to fetch custom metadata, you must restrict the selection to document types that contain the metadata. For example, if you have a metadata "custom" in a document type "mytype", then your query would be something like:

    ```
    curl -u Administrator:Administrator "http://localhost:8080/nuxeo/atom/cmis/default/query?q=SELECT+cmis:objectId,+mytype:custom+FROM+mytype&searchAllVersions=true"
    ```

### SOAP

The following SOAP endpoints are available:

- `http://localhost:8080/nuxeo/webservices/cmis/RepositoryService?wsdl`
- `http://localhost:8080/nuxeo/webservices/cmis/DiscoveryService?wsdl`
- `http://localhost:8080/nuxeo/webservices/cmis/ObjectService?wsdl`
- `http://localhost:8080/nuxeo/webservices/cmis/NavigationService?wsdl`
- `http://localhost:8080/nuxeo/webservices/cmis/VersioningService?wsdl`
- `http://localhost:8080/nuxeo/webservices/cmis/RelationshipService?wsdl`
- `http://localhost:8080/nuxeo/webservices/cmis/MultiFilingService?wsdl`
- `http://localhost:8080/nuxeo/webservices/cmis/ACLService?wsdl`
- `http://localhost:8080/nuxeo/webservices/cmis/PolicyService?wsdl`

Authentication is done using Web Services Security (WSS) UsernameToken.

Here is a working example of a SOAP message to the DiscoveryService:

```xml
<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://docs.oasis-open.org/ns/cmis/messaging/200908/">
  <soapenv:Header>
    <Security xmlns="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd">
      <UsernameToken>
        <Username>Administrator</Username>
        <Password>Administrator</Password>
      </UsernameToken>
    </Security>
  </soapenv:Header>
  <soapenv:Body>
    <ns:query>
      <ns:repositoryId>default</ns:repositoryId>
      <ns:statement>SELECT cmis:objectid, dc:title FROM cmis:document WHERE dc:title = 'Workspaces'</ns:statement>
      <ns:maxItems>20</ns:maxItems>
      <ns:skipCount>0</ns:skipCount>
    </ns:query>
  </soapenv:Body>
</soapenv:Envelope>

```

### CMIS Clients

Several free clients for CMIS 1.1 are available. The most complete is the [CMIS Workbench](http://chemistry.apache.org/java/developing/tools/dev-tools-workbench.html), part of OpenCMIS.

Developers can use the [Chemistry libraries](http://chemistry.apache.org/) to produce their own client (Java, Python, PHP, .NET). Documentation and sample for using OpenCMIS libraries can be found on the [OpenCMIS developer wiki](http://chemistry.apache.org/java/developing/index.html) with also [example code](http://chemistry.apache.org/java/examples/index.html) and [how-to guides](http://chemistry.apache.org/java/how-to/index.html).

### From Java Code Within a Nuxeo Component

To create, delete or modify documents, folders and relations just use the regular `CoreSession` API of Nuxeo. To perform CMISQL queries (for instance to be able to perform `JOIN` that are not supported by the default `NXQL` query language) have a look at the page [Using CMISQL from Java]({{page page='using-cmisql-from-java'}}).

## Capabilities {{> anchor 'capabilities'}}

The Nuxeo OpenCMIS connector implements the following capabilities from the specification:

<div class="table-scroll">
<table class="hover">
<tbody>
<tr><td colspan="3">**Navigation Capabilities**</td></tr>
<tr><td colspan="1">&nbsp;</td><td colspan="1">Get descendants supported</td><td colspan="1">_Yes_</td></tr>
<tr><td colspan="1">&nbsp;</td><td colspan="1">Get folder tree supported</td><td colspan="1">_Yes_</td></tr>
<tr><td colspan="1">&nbsp;</td><td colspan="1">Order By supported</td><td colspan="1">_Custom_</td></tr>
<tr><td colspan="3">**Object Capabilities**</td></tr>
<tr><td colspan="1">&nbsp;</td><td colspan="1">Content stream updates</td><td colspan="1">_PWC only_</td></tr>
<tr><td colspan="1">&nbsp;</td><td colspan="1">Changes</td><td colspan="1">_Object IDs only_</td></tr>
<tr><td colspan="1">&nbsp;</td><td colspan="1">Renditions</td><td colspan="1">_Read_</td></tr>
<tr><td colspan="3">**Filing Capabilities**</td></tr>
<tr><td colspan="1">&nbsp;</td><td colspan="1">Multifiling supported</td><td colspan="1">_No_</td></tr>
<tr><td colspan="1">&nbsp;</td><td colspan="1">Unfiling supported</td><td colspan="1">_No_</td></tr>
<tr><td colspan="1">&nbsp;</td><td colspan="1">Version-specific filing supported</td><td colspan="1">_No_</td></tr>
<tr><td colspan="3">**Versioning Capabilities**</td></tr>
<tr><td colspan="1">&nbsp;</td><td colspan="1">PWC updatable</td><td colspan="1">_Yes_</td></tr>
<tr><td colspan="1">&nbsp;</td><td colspan="1">PWC searchable</td><td colspan="1">_Yes_</td></tr>
<tr><td colspan="1">&nbsp;</td><td colspan="1">All versions searchable</td><td colspan="1">_Yes_</td></tr>
<tr><td colspan="3">**Query Capabilities**</td></tr>
<tr><td colspan="1">&nbsp;</td><td colspan="1">Query</td><td colspan="1">_Both combined_</td></tr>
<tr><td colspan="1">&nbsp;</td><td colspan="1">Joins</td><td colspan="1">_None_<br>(_Inner and outer_ if `org.nuxeo.cmis.joins=true`)</td></tr>
<tr><td colspan="3">**Type Capabilities**</td></tr>
<tr><td colspan="1">&nbsp;</td><td colspan="1">Create property types</td><td colspan="1">_No_</td></tr>
<tr><td colspan="1">&nbsp;</td><td colspan="1">New type settable attributes</td><td colspan="1">_None_</td></tr>
<tr><td colspan="3">**ACL Capabilities**</td></tr>
<tr><td colspan="1">&nbsp;</td><td colspan="1">ACLs</td><td colspan="1">_Manage_</td></tr>
<tr><td colspan="1">&nbsp;</td><td colspan="1">ACLs propagation</td><td colspan="1">_Propagate_</td></tr>
<tr><td colspan="1">&nbsp;</td><td colspan="1">Supported permissions</td><td colspan="1">_Repository_ </td>
</tr>
</tbody>
</table>
</div>

## Model Mapping {{> anchor 'mapping'}}

The following describes how Nuxeo documents are mapped to CMIS objects and vice versa.

*   Only Nuxeo documents including the "dublincore" schema are visible in CMIS.
*   Complex properties are not visible in CMIS by default, as this notion does not exist in CMIS. However, if the server is configured to do so, they can be exposed as JSON-encoded strings (since Nuxeo 7.1, see [NXP-14474](https://jira.nuxeo.com/browse/NXP-14474)).
*   Dynamic facets are visible as CMIS 1.1 secondary types (since Nuxeo 7.1, see [NXP-15070](https://jira.nuxeo.com/browse/NXP-15070)).
*   Proxy documents are visible in CMIS if the system property `org.nuxeo.cmis.proxies=true` (since Nuxeo 8.3 / Nuxeo 7.10-HF08 (default `true` since Nuxeo 9.1, `false` in previous versions), see [NXP-17313](https://jira.nuxeo.com/browse/NXP-17313) and [NXP-21828](https://jira.nuxeo.com/browse/NXP-21828)).
*   Secondary content streams are not visible as renditions. Only the Nuxeo thumbnail and renditions explicitly made available through the Nuxeo RenditionService are visible.
*   Documents in the Nuxeo trash (those whose `nuxeo:isTrashed` is `true`) are not visible in CMIS, unless an explicit query using the `nuxeo:isTrashed` property is done.

This mapping may change to be more comprehensive in future Nuxeo Platform versions.

## Nuxeo-Specific System Properties

In addition to the system properties defined in the CMIS specification under the `cmis:` prefix, the Nuxeo Platform adds some additional properties under the `nuxeo:` prefix:

*   `nuxeo:isTrashed`: To access the trashed state of a document. By default only **non-trashed** document will be returned in CMISQL queries unless an explicit `nuxeo:isTrashed` predicate is specifiedin the `WHERE` clause of the query.
*   `nuxeo:isVersion`: To distinguish between archived (read-only revision) and live documents (that can be edited).
*   `nuxeo:lifecycleState`: To access the lifecycle state of a document.
*   `nuxeo:secondaryObjectTypeIds`: Makes it possible to access the facets of a document. Those facets can be static (as defined in the type definitions) or dynamic (each document instance can have declared facets).
*   `nuxeo:contentStreamDigest`: The low level, MD5 or SHA1 digest of blobs stored in the repository. The algorithm used to compute the digest is dependent on the configuration of the `BinaryManager` component of the Nuxeo repository.
*   `nuxeo:isCheckedIn`: For live documents, distinguishes between the checked-in and checked-out state.
*   `nuxeo:parentId`: Like `cmis:parentId` but also available on Document objects (which is possible because the Nuxeo Platform does not have direct multi-filing).
*   `nuxeo:pathSegment`: The last path segment of the document (`ecm:name` in NXQL).
*   `nuxeo:pos`: The position of an object in its containing folder, if that folder is ordered, or `null` otherwise.

All these properties can be used as regular CMIS properties and in a CMISQL query (in a `SELECT`, `WHERE` or `ORDER BY` clause where relevant), except for `nuxeo:contentStreamDigest` which can only be read in query results or by introspecting the properties of the `ObjectData` representation of a document.

## Use Cases

### Document Capture Integration with Ephesoft

Ephesoft is an advanced document capture and data extraction solution to help businesses run more efficiently. It automatically classifies and extracts data from any type of document. Ephesoft has a CMIS interface, which ease the integration with Nuxeo.

Ephesoft has a CMIS import plugin and a CMIS export plugin so that it can ingest documents stored in Nuxeo to extract information and send back the extraction results to Nuxeo.

#### CMIS Import

Ephesoft monitors a specified folder for a new file (as a hot folder) using a cron job, and process any new document in an Ephesoft batch. Ephesoft uses a "technical" Nuxeo property to tag the document as processed, in order to not process twice the same document (for example, a custom property called `invoice:status` passes from `To process` to `Processed`).

![]({{file name='ephesoft_cmis_import.png'}} ?w=600,border=true)

In the picture above:

| Parameter | Value | Description |
| --- | --- |
| Server URL | `http://localhost:8080/nuxeo/atom/cmis` | Nuxeo CMIS URL |
| Username | `ephesoft` | Username of the technical account to create a connexion between Nuxeo and Ephesoft. This user needs **WRITE** permission on the documents |
| Password | `mySecretPassword` | Password of the technical account |
| Repository Id | `default` | Generally `default`. You can read it from the downloaded file when you enter in a web browser the CMIS Server URL |
| File Extension | `pdf;tif` | Cannot be changed |
| Folder | `default/domain/workspaces/folder1` | Folder path of the hot folder. The initial `/` **should not** be written |
| Property | `invoice:status` | Property used by Ephesoft to check which document has been processed |
| Value | `To process` | Each document with `invoice:status=To Process` will be sent to Ephesoft |
| New Value | `Processed` | When Ephesoft processes a document, Ephesoft will update the `invoice:status` to `Processed` |
| CMIS Version | `1.1` | Value of the CMIS implementation |
| Enabled | `true` | To activate the CMIS Import |

{{#> callout type='info' }}

Don't forget to activate the CMIS import by uncommenting the `<import resource="classpath:/META-INF/applicationContext-dcma-mail-import.xml" />` line of the `applicationContext.xml` file as the CMIS import is disabled by default.

{{/callout}}

{{#> callout type='warning' }}
With the standard CMIS import addon, you can't keep the original Nuxeo property values from the input to the output. One possible workaround is to check if the binary you're processing has any file property (contained for example in the EXIF or IPTC format) that you can use to perform a synchronization process. The best practice is to use the CMIS REST API instead of the CMIS Import addon to get more flexibility.
{{/callout}}

#### CMIS Export

When a document is processed in Ephesoft, it means the platform has classified and extracted the information from the document. Instead of exporting the binary files in a filesystem folder, along with its XML document (corresponding to the field properties), you can export them into Nuxeo with the CMIS export addon. The configuration is quite easy:

1. Activate the CMIS Export in your Ephesoft batch class modules
1. Map the Ephesoft property fields with the Nuxeo property fields in the `DLF-attributes-mapping.properties`
```
invoice=Invoice
invoice.number=invoice:number
invoice.details=dc:description
...
```
1. Configure the CMIS export properties:

![]({{file name='ephesoft_cmis_export.png'}} ?w=600,border=true)

Here is the list of the most important properties:

| Parameter | Value | Description |
| --- | --- |
| Cmis Root Folder Name | `default-domain/workspaces/invoices_processed` | Nuxeo Folder where Ephesoft exports the documents and its properties. The initial `/` **should not** be written  |
| Cmis Upload File Extension | `tif` | It can be either `tif` or `pdf` |
| Cmis Server URL | `http://localhost:8080/nuxeo/atom/cmis` | Nuxeo CMIS URL |
| Cmis Server User Name | `ephesoft` | Username of the technical account to create a connexion between Nuxeo and Ephesoft. This user needs **WRITE** permission on the `Cmis Root Folder Name` to upload documents |
| Cmis Server Switch ON/OFF | `ON` | If set to OFF, the CMIS export is disabled |
| CMIS Export File Name | `$BATCH_IDENTIFIER & _ & $DOCUMENT_ID` | `dc:title` value of the exported document. Any extracted information from the document can be reused with the `$` character |

### Custom CMIS Integration

[Watch this 15 min video](https://nuxeo.wistia.com/medias/rzvybdq540) presenting a custom case-processing application started from scratch, leveraging CMIS.

## Resources

### Source Code

- The Nuxeo OpenCMIS connector source code on GitHub: [https://github.com/nuxeo/nuxeo-chemistry](https://github.com/nuxeo/nuxeo-chemistry).
- The Apache Chemistry OpenCMIS source code on Apache's Subversion server: [https://svn.apache.org/repos/asf/chemistry/opencmis/trunk](https://svn.apache.org/repos/asf/chemistry/opencmis/trunk).

### Documentation

- [CMIS 1.1 (HTML)](http://docs.oasis-open.org/cmis/CMIS/v1.1/CMIS-v1.1.html),
- [CMIS 1.1 (PDF)](http://docs.oasis-open.org/cmis/CMIS/v1.1/CMIS-v1.1.pdf) (1.3 MB).

### Slide Decks

- [CMIS and Apache Chemistry](http://www.slideshare.net/efge/cmis-and-apache-chemistry-apachecon-2010), ApacheCon 2010 presentation on SlideShare

### Blog Posts

- [CMIS: A Tale of Versioning](http://www.nuxeo.com/blog/cmis-tale-versioning/)
- [Direct Document Capture in Nuxeo Using Ephesoft and CMIS](http://www.nuxeo.com/blog/direct-document-capture-nuxeo-using-ephesoft-cmis/)
- [Complex Types, Multiple Streams and Renditions in CMIS!](http://www.nuxeo.com/blog/complex-types-multiple-streams-renditions-cmis/)
- [Direct Document Capture in Nuxeo Using Ephesoft and CMIS](https://www.nuxeo.com/blog/direct-document-capture-nuxeo-using-ephesoft-cmis/)
