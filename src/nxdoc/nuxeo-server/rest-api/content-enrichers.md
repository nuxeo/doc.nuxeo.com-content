---
title: Content Enrichers
description: The Nuxeo Platform provides you with several content enrichers out of the box for the most common use cases, and you can contribute your own if needed.
review:
    comment: ''
    date: '2017-12-11'
    status: ok
labels:
    - lts2016-ok
    - link-update
    - rest-api
    - troger
    - enricher
    - university
    - lts2017-ok
toc: true
version_override:
    LTS 2015: 710/nxdoc/content-enricher
    '6.0': 60/nxdoc/content-enricher
confluence:
    ajs-parent-page-id: '13664833'
    ajs-parent-page-title: REST API
    ajs-space-key: NXDOC
    ajs-space-name: Nuxeo Platform Developer Documentation
    canonical: Content+Enricher
    canonical_source: 'https://doc.nuxeo.com/display/NXDOC/Content+Enricher'
    page_id: '19793383'
    shortlink: 5wUuAQ
    shortlink_source: 'https://doc.nuxeo.com/x/5wUuAQ'
    source_link: /display/NXDOC/Content+Enricher
tree_item_index: 400
history:
    -
        author: Arnaud Kervern
        date: '2016-08-16 09:46'
        message: ''
        version: '55'
    -
        author: Arnaud Kervern
        date: '2016-08-16 09:45'
        message: ''
        version: '54'
    -
        author: Arnaud Kervern
        date: '2016-08-16 09:42'
        message: ''
        version: '53'
    -
        author: Solen Guitter
        date: '2016-07-29 16:18'
        message: Add missing excerpts for page Leaning the REST API
        version: '52'
    -
        author: Solen Guitter
        date: '2016-07-04 08:30'
        message: Add since 8.3 mention on Tags
        version: '51'
    -
        author: Guillaume Renard
        date: '2016-07-01 13:02'
        message: ''
        version: '50'
    -
        author: Manon Lumeau
        date: '2016-06-02 09:49'
        message: ''
        version: '49'
    -
        author: Guillaume Renard
        date: '2016-06-01 09:39'
        message: ''
        version: '48'
    -
        author: Guillaume Renard
        date: '2016-06-01 09:03'
        message: ''
        version: '47'
    -
        author: Guillaume Renard
        date: '2016-06-01 09:02'
        message: Reverted from v. 44
        version: '46'
    -
        author: Guillaume Renard
        date: '2016-06-01 09:00'
        message: ''
        version: '45'
    -
        author: Guillaume Renard
        date: '2016-06-01 08:57'
        message: ''
        version: '44'
    -
        author: Guillaume Renard
        date: '2016-06-01 08:54'
        message: ''
        version: '43'
    -
        author: Guillaume Renard
        date: '2016-06-01 08:52'
        message: ''
        version: '42'
    -
        author: Guillaume Renard
        date: '2016-06-01 08:48'
        message: ''
        version: '41'
    -
        author: Bertrand Chauvin
        date: '2016-05-03 13:02'
        message: ''
        version: '40'
    -
        author: Thomas Roger
        date: '2015-11-04 13:32'
        message: ''
        version: '39'
    -
        author: Vladimir Pasquier
        date: '2015-11-02 18:49'
        message: ''
        version: '38'
    -
        author: Vladimir Pasquier
        date: '2015-11-02 18:39'
        message: ''
        version: '37'
    -
        author: Manon Lumeau
        date: '2015-11-02 15:57'
        message: ''
        version: '36'
    -
        author: Bertrand Chauvin
        date: '2015-10-19 16:09'
        message: ''
        version: '35'
    -
        author: Bertrand Chauvin
        date: '2015-10-19 16:06'
        message: Added video
        version: '34'
    -
        author: Nicolas Chapurlat
        date: '2015-10-13 14:47'
        message: ''
        version: '33'
    -
        author: Nicolas Chapurlat
        date: '2015-10-13 14:44'
        message: ''
        version: '32'
    -
        author: Benoit Delbosc
        date: '2015-09-16 10:11'
        message: Fix header format
        version: '31'
    -
        author: Vladimir Pasquier
        date: '2015-09-10 19:08'
        message: ''
        version: '30'
    -
        author: Solen Guitter
        date: '2015-09-08 07:40'
        message: Format
        version: '29'
    -
        author: Bertrand Chauvin
        date: '2015-09-07 09:37'
        message: Added how to call enrichers section
        version: '28'
    -
        author: Bertrand Chauvin
        date: '2015-09-07 09:28'
        message: Fixed typo
        version: '27'
    -
        author: Bertrand Chauvin
        date: '2015-09-07 09:28'
        message: Fixed contributing your enricher section
        version: '26'
    -
        author: Bertrand Chauvin
        date: '2015-09-04 09:00'
        message: Fixed formatting and unneeded text
        version: '25'
    -
        author: Bertrand Chauvin
        date: '2015-09-04 08:59'
        message: 'Added how to contribute an enricher, fixed XML'
        version: '24'
    -
        author: Thomas Roger
        date: '2015-08-05 09:39'
        message: ''
        version: '23'
    -
        author: Thomas Roger
        date: '2015-08-05 09:38'
        message: ''
        version: '22'
    -
        author: Solen Guitter
        date: '2015-05-04 09:03'
        message: 'Add links to javadoc, and children and permission enrichers in additional enrichers sections'
        version: '21'
    -
        author: Solen Guitter
        date: '2015-04-30 15:54'
        message: 'Update response examples from 7.2, add breadcrumb enricher'
        version: '20'
    -
        author: Solen Guitter
        date: '2015-04-30 09:58'
        message: Replacing deprecated headers X-NXContext-Category and X-NXDocumentProperties by X-NXenrichers.document and X-NXproperties
        version: '19'
    -
        author: Solen Guitter
        date: '2015-04-30 09:26'
        message: typo
        version: '18'
    -
        author: Solen Guitter
        date: '2014-12-16 10:48'
        message: ''
        version: '17'
    -
        author: Nelson Silva
        date: '2014-12-16 10:30'
        message: ''
        version: '16'
    -
        author: Nelson Silva
        date: '2014-12-15 10:21'
        message: Add parameters and vocabulary enricher
        version: '15'
    -
        author: Manon Lumeau
        date: '2014-10-06 11:35'
        message: ''
        version: '14'
    -
        author: Vladimir Pasquier
        date: '2014-10-02 14:04'
        message: ''
        version: '13'
    -
        author: Vladimir Pasquier
        date: '2014-10-02 14:02'
        message: Add preview content enricher
        version: '12'
    -
        author: Solen Guitter
        date: '2014-08-21 15:09'
        message: Formatting
        version: '11'
    -
        author: Vladimir Pasquier
        date: '2014-08-20 11:08'
        message: ''
        version: '10'
    -
        author: Solen Guitter
        date: '2014-07-28 09:23'
        message: formatting
        version: '9'
    -
        author: Vincent Dutat
        date: '2014-07-24 17:55'
        message: ''
        version: '8'
    -
        author: Vincent Dutat
        date: '2014-07-24 17:49'
        message: ''
        version: '7'
    -
        author: Vladimir Pasquier
        date: '2014-07-24 17:15'
        message: little update on content enrich
        version: '6'
    -
        author: Vladimir Pasquier
        date: '2014-07-24 15:54'
        message: renaming rest contrib into content enrich
        version: '5'
    -
        author: Vladimir Pasquier
        date: '2014-07-24 14:18'
        message: ''
        version: '4'
    -
        author: Vladimir Pasquier
        date: '2014-07-22 11:05'
        message: ''
        version: '3'
    -
        author: Vladimir Pasquier
        date: '2014-07-22 11:03'
        message: Rest Contributors
        version: '2'
    -
        author: Alain Escaffre
        date: '2014-07-03 00:58'
        message: ''
        version: '1'
---
## Pluggable Context

Sometimes it's useful to optimize the number of requests you send to the server. For this reason, we provide a mechanism for requesting more information on the response, simply by specifying the context you require in the request header.

For example, sometimes you need to get the children, parents or workflow tasks of a document while requesting that document. The Nuxeo Platform provides you with several content enrichers out of the box for the most common use cases, and you can contribute your own if needed.

## Default Content Enrichers

<div class="table-scroll">
  <table class="hover">
    <tbody>
      <tr>
        <th>Enricher</th>
        <th>Included in Response:</th>
      </tr>
      <tr>
        <td>`thumbnail`</td>
        <td>Related attached file thumbnail of the current document</td>
      </tr>
      <tr>
        <td>`preview`</td>
        <td>Related attached file preview of the current document</td>
      </tr>
      <tr>
        <td>`documentURL`</td>
        <td>Document's URL</td>
      </tr>
      <tr>
        <td>`breadcrumb`</td>
        <td>Document breadcrumb (list of all parent documents)</td>
      </tr>
      <tr>
        <td>`subtypes`</td>
        <td>Array of document types that can be created under the current document</td>
      </tr>
      <tr>
        <td>`children`</td>
        <td>List of all children documents</td>
      </tr>
      <tr>
        <td>`hasContent`</td>
        <td>Boolean flag indicating whether or not current Folderish or Collection document has children or members</td>
      </tr>
      <tr>
        <td>`hasFolderishChild`</td>
        <td>Boolean flag indicating whether or not current document has folderish child document</td>
      </tr>
      <tr>
        <td>`favorites`</td>
        <td>Boolean flag indicating whether or not current document belongs to user's Favorites</td>
      </tr>
      <tr>
        <td>`collections`</td>
        <td>The collections to which the current document belongs</td>
      </tr>
      <tr>
        <td>`tags`</td>
        <td>The tags on the current document</td>
      </tr>
      <tr>
        <td>`firstAccessibleAncestor`</td>
        <td>The closest document's ancestor which is used to find what safe document to redirect to when deleting some.</td>
      </tr>
      <tr>
        <td>`runningWorkflows`</td>
        <td>Workflow instances running on the current document</td>
      </tr>
      <tr>
        <td>`runnableWorkflows`</td>
        <td>Workflow models that can be launched on the current document</td>
      </tr>
      <tr>
        <td>`pendingTasks`</td>
        <td>Pending tasks on the current document</td>
      </tr>
      <tr>
        <td>`acls`</td>
        <td>All related ACLs of the current document</td>
      </tr>
      <tr>
        <td>`permissions`</td>
        <td>Current user's permissions on the current document</td>
      </tr>
      <tr>
        <td>`publications`</td>
        <td>Publication count of the current document</td>
      </tr>
      <tr>
        <td>`userVisiblePermissions`</td>
        <td>List of permissions available on current document</td>
      </tr>
      <tr>
        <td>`audit`</td>
        <td>Latest log entries related to the current document</td>
      </tr>
      <tr>
        <td>`subscribedNotifications`</td>
        <td>Current user's subscribed notifications for the current document</td>
      </tr>
      <tr>
        <td>`userprofile`</td>
        <td>DOB, phone number and avatar of current user</td>
      </tr>
    </tbody>
  </table>
</div>

## How To Call a Content Enricher

Content enrichers can be called by sending the proper header(s) in your request. The header you need to call depends on the entity-type being affected by the enricher. Enrichers on documents can be called using the header:

```
enrichers.document: enricherName
```

If you want to call an enricher on a user, you would do it through a slightly different header:

```
enrichers.user: enricherName
```

Several enrichers can be called in a single request by specifying a comma separated list in the header, or by sending several headers:

```
enrichers.document: enricher1,enricher2,enricher3
```

is equivalent to sending:

```
enrichers.document: enricher1
enrichers.document: enricher2
enrichers.document: enricher3
```

The enrichers can be called the same way by passing GET parameters.

```
http://NUXEO_SERVER/nuxeo/api/v1/path/default-domain/workspaces?enrichers.document=enricher1,enricher2
http://NUXEO_SERVER/nuxeo/api/v1/path/default-domain/workspaces?enrichers.document=enricher1&enrichers.document=enricher2
```

## Examples

### Thumbnail

{{#> panel type='code' heading='Call Example'}}

```
Request URL:
http://NUXEO_SERVER/nuxeo/api/v1/id/4246ca87-c076-4bf4-b62b-0bab9dd21102
 Request Method: GET
 Request Headers
 ...
 Content-type: application/json
 enrichers.document: thumbnail
 properties: dublincore
```

{{/panel}}{{#> panel type='code' heading='JSON Response Example'}}

```
{
  "entity-type": "document",
  "repository": "default",
  "uid": "4246ca87-c076-4bf4-b62b-0bab9dd21102",
  "path": "/default-domain/workspaces/Marketing/photo.jpg",
  "type": "Picture",
  "state": "project",
  "parentRef": "036f99ec-a500-4a1e-9d89-e8eb656a0ff7",
  "isCheckedOut": true,
  "changeToken": "1426696491000",
  "title": "photo.jpg",
  "lastModified": "2015-03-18T16:34:51.00Z",
  "properties": {
    "dc:description": "",
    ...
  },
  "facets": [
    "Versionable",
    ...
  ],
  "contextParameters": {
    "thumbnail": {
      "url": "http://NUXEO_SERVER/nuxeo/api/v1/4246ca87-c076-4bf4-b62b-0bab9dd21102/@rendition/thumbnail"
    }
  }
}
```

{{/panel}}

More details about the thumbnail enricher: [http://community.nuxeo.com/api/nuxeo/latest/javadoc/org/nuxeo/ecm/platform/thumbnail/io/ThumbnailJsonEnricher.html](http://community.nuxeo.com/api/nuxeo/latest/javadoc/org/nuxeo/ecm/platform/thumbnail/io/ThumbnailJsonEnricher.html)

### ACLs

{{#> panel type='code' heading='Call Example'}}

```
Request URL: http://NUXEO_SERVER/nuxeo/api/v1/id/036f99ec-a500-4a1e-9d89-e8eb656a0ff7
Request Method: GET
Request Headers
...
Content-type: application/json
enrichers.document: acls
properties: dublincore
```

{{/panel}}{{#> panel type='code' heading='JSON Response Example'}}

```
{
  "entity-type": "document",
  "repository": "default",
  "uid": "036f99ec-a500-4a1e-9d89-e8eb656a0ff7",
  "path": "/default-domain/workspaces/Marketing",
  "type": "Workspace",
  "state": "project",
  "parentRef": "02d7b1d5-791a-4939-ae6e-aaa75c05bd2c",
  "isCheckedOut": true,
  "changeToken": "1426695969000",
  "title": "Marketing",
  "lastModified": "2015-03-18T16:26:09.00Z",
  "properties": {
    "dc:description": “”,
    ...
  },
  "facets": [
    "Folderish",
    ...
  ],
  "contextParameters": {
    "acls": [{
      "name": "local",
      "aces": [{
        "username": "jsmith",
        "permission": "ReadWrite",
        "granted": true
      }]
    }, {
      "name": "inherited",
      "aces": [{
        "username": "jdoe",
        "permission": "Everything",
        "granted": true
      }, {
        "username": "Administrator",
        "permission": "Everything",
        "granted": true
      }, {
        "username": "members",
        "permission": "Read",
        "granted": true
      }]
    }]
  }
}
```

{{/panel}}

More details about the ACLs enricher: [http://community.nuxeo.com/api/nuxeo/latest/javadoc/org/nuxeo/ecm/permissions/ACLJsonEnricher.html](http://community.nuxeo.com/api/nuxeo/latest/javadoc/org/nuxeo/ecm/permissions/ACLJsonEnricher.html)

### Preview

{{#> panel type='code' heading='Call Example'}}

```
Request URL:
http://localhost:18090/api/v1/repo/test/path/folder_1/photo.jpg
 Request Method: GET
 Request Headers
 ...
 Content-type: application/json
 enrichers.document: preview
 properties: dublincore
```

{{/panel}}{{#> panel type='code' heading='JSON Response Example'}}

```
{
  "entity-type": "document",
  "repository": "default",
  "uid": "4246ca87-c076-4bf4-b62b-0bab9dd21102",
  "path": "/default-domain/workspaces/Marketing/photo.jpg",
  "type": "Picture",
  "state": "project",
  "parentRef": "036f99ec-a500-4a1e-9d89-e8eb656a0ff7",
  "isCheckedOut": true,
  "changeToken": "1426696491000",
  "title": “photo.jpg ",
  "lastModified": "2015-03-18T16:34:51.00Z",
  "properties": {
    "dc:description": “”,
    ...
  },
  "facets": [
    "Versionable",
    ...
  ],
  "contextParameters": {
    "preview": {
      "url": "http://NUXEO_SERVER/nuxeo/restAPI/preview/default/4246ca87-c076-4bf4-b62b-0bab9dd21102/default/"
    }
  }
}
```

{{/panel}}

More details about the preview enricher: [http://community.nuxeo.com/api/nuxeo/latest/javadoc/org/nuxeo/ecm/platform/preview/io/PreviewJsonEnricher.html](http://community.nuxeo.com/api/nuxeo/latest/javadoc/org/nuxeo/ecm/platform/preview/io/PreviewJsonEnricher.html)

### Breadcrumb

{{#> panel type='code' heading='Call Example'}}

```
Request URL:
http://NUXEO_SERVER/nuxeo/api/v1/id/4246ca87-c076-4bf4-b62b-0bab9dd21102
 Request Method: GET
 Request Headers
 ...
 Content-type: application/json
 enrichers.document: breadcrumb
 properties: dublincore
```

{{/panel}}{{#> panel type='code' heading='JSON Response Example'}}

```
{
  "entity-type": "document",
  "repository": "default",
  "uid": "4246ca87-c076-4bf4-b62b-0bab9dd21102",
  "path": "/default-domain/workspaces/Marketing/IMG_20141004_132816.jpg",
  "type": "Picture",
  "state": "project",
  "parentRef": "036f99ec-a500-4a1e-9d89-e8eb656a0ff7",
  "isCheckedOut": true,
  "changeToken": "1426696491000",
  "title": "IMG_20141004_132816.jpg",
  "lastModified": "2015-03-18T16:34:51.00Z",
  "properties": {
    "dc:description": "",
    ...
  },
  "facets": [
    "Versionable",
    ...
  ],
  "contextParameters": {
    "breadcrumb": {
      "entity-type": "documents",
      "entries": [{
          "entity-type": "document",
          "repository": "default",
          "uid": "42bbc2f6-13bd-4eb1-8c35-07342358f5f8",
          "path": "/default-domain",
          "type": "Domain",
          "state": "project",
          "parentRef": "22288b40-7879-4665-b01e-b9bacb132506",
          "isCheckedOut": true,
          "changeToken": "1426694633000",
          "title": "Default domain",
          "lastModified": "2015-03-18T16:03:53.00Z",
          "facets": [
            "Folderish",
            ...
          ]
        }, {
          "entity-type": "document",
          ...
        }, {
          "entity-type": "document",
          ...
        }, {
          "entity-type": "document",
          ...
        ]
      }
    ]
  }
}
}
```

{{/panel}}

More details about the breadcrumb enricher: [http://community.nuxeo.com/api/nuxeo/latest/javadoc/org/nuxeo/ecm/core/io/marshallers/json/enrichers/BreadcrumbJsonEnricher.html](http://community.nuxeo.com/api/nuxeo/latest/javadoc/org/nuxeo/ecm/core/io/marshallers/json/enrichers/BreadcrumbJsonEnricher.html)

### Favorites

{{#> panel type='code' heading='Call Example'}}

```
Request URL:
http://NUXEO_SERVER/nuxeo/api/v1/id/4246ca87-c076-4bf4-b62b-0bab9dd21102
 Request Method: GET
 Request Headers
 ...
 Content-type: application/json
 enrichers.document: favorites
 properties: dublincore
```

{{/panel}}{{#> panel type='code' heading='JSON Response Example'}}

```
{
  "entity-type": "document",
  "repository": "default",
  "uid": "4246ca87-c076-4bf4-b62b-0bab9dd21102",
  "path": "/default-domain/workspaces/Marketing/photo.jpg",
  "type": "Picture",
  "state": "project",
  "parentRef": "036f99ec-a500-4a1e-9d89-e8eb656a0ff7",
  "isCheckedOut": true,
  "changeToken": "1426696491000",
  "title": "photo.jpg",
  "lastModified": "2015-03-18T16:34:51.00Z",
  "properties": {
    "dc:description": "",
    ...
  },
  "facets": [
    "Versionable",
    ...
  ],
  "contextParameters": {
    "favorites": {
      "isFavorite": true
    }
  }
}
```

{{/panel}}

### Collections

{{#> panel type='code' heading='Call Example'}}

```
Request URL:
http://NUXEO_SERVER/nuxeo/api/v1/id/4246ca87-c076-4bf4-b62b-0bab9dd21102
 Request Method: GET
 Request Headers
 ...
 Content-type: application/json
 enrichers.document: collections
 properties: dublincore
```

{{/panel}}{{#> panel type='code' heading='JSON Response Example'}}

```
{
  "entity-type": "document",
  "repository": "default",
  "uid": "4246ca87-c076-4bf4-b62b-0bab9dd21102",
  "path": "/default-domain/workspaces/Marketing/photo.jpg",
  "type": "Picture",
  "state": "project",
  "parentRef": "036f99ec-a500-4a1e-9d89-e8eb656a0ff7",
  "isCheckedOut": true,
  "changeToken": "1426696491000",
  "title": "photo.jpg",
  "lastModified": "2015-03-18T16:34:51.00Z",
  "properties": {
    "dc:description": "",
    ...
  },
  "facets": [
    "Versionable",
    ...
  ],
  "contextParameters": {
    "collections": [{
      "changeToken": "1464771452017",
      "entity-type": "document",
      "facets": [
        "Versionable",
        "Collection",
        "NotCollectionMember"
      ],
      "isCheckedOut": true,
      "lastModified": "2016-06-01T08:57:32.01Z",
      "parentRef": "8e62af0a-a74c-4bd1-96a4-66034834bf3b",
      "path": "/default-domain/UserWorkspaces/Administrator/Collections/Fox Icons",
      "repository": "default",
      "state": "project",
      "title": "Fox Icons",
      "type": "Collection",
      "uid": "50110ba5-b129-40b2-9880-3d9783710404"
    }]
  }
}
```

{{/panel}}

### Tags

{{#> panel type='code' heading='Call Example'}}

```
Request URL:
http://NUXEO_SERVER/nuxeo/api/v1/id/4246ca87-c076-4bf4-b62b-0bab9dd21102
 Request Method: GET
 Request Headers
 ...
 Content-type: application/json
 enrichers.document: tags
 properties: dublincore
```

{{/panel}}{{#> panel type='code' heading='JSON Response Example'}}

```
{
  "entity-type": "document",
  "repository": "default",
  "uid": "4246ca87-c076-4bf4-b62b-0bab9dd21102",
  "path": "/default-domain/workspaces/Marketing/photo.jpg",
  "type": "Picture",
  "state": "project",
  "parentRef": "036f99ec-a500-4a1e-9d89-e8eb656a0ff7",
  "isCheckedOut": true,
  "changeToken": "1426696491000",
  "title": "photo.jpg",
  "lastModified": "2015-03-18T16:34:51.00Z",
  "properties": {
    "dc:description": "",
    ...
  },
  "facets": [
    "Versionable",
    ...
  ],
  "contextParameters": {
    "tags": [{
      "label": "My Tag",
      "weight": 0
    }]
  },
}
```

{{/panel}}

### First Accessible Ancestor

{{#> panel type='code' heading='Call Example'}}

```
Request URL:
http://NUXEO_SERVER/nuxeo/api/v1/id/4246ca87-c076-4bf4-b62b-0bab9dd21102
 Request Method: GET
 Request Headers
 ...
 Content-type: application/json
 enrichers.document: firstAccessibleAncestor
 properties: dublincore
```

{{/panel}}{{#> panel type='code' heading='JSON Response Example'}}

```
{
  "entity-type": "document",
  "repository": "default",
  "uid": "4246ca87-c076-4bf4-b62b-0bab9dd21102",
  "path": "/default-domain/workspaces/Marketing/photo.jpg",
  "type": "Picture",
  "state": "project",
  "parentRef": "036f99ec-a500-4a1e-9d89-e8eb656a0ff7",
  "isCheckedOut": true,
  "changeToken": "1426696491000",
  "title": "photo.jpg",
  "lastModified": "2015-03-18T16:34:51.00Z",
  "properties": {
    "dc:description": "",
    ...
  },
  "facets": [
    "Versionable",
    ...
  ],
  "contextParameters": {
    "firstAccessibleAncestor": {
        "entity-type": "document",
        "path": "/default-domain/workspaces/Marketing",
        ...
    }
  },
}
```

{{/panel}}

### {{> anchor 'runningWorkflows'}}Running Workflows

{{#> panel type='code' heading='Call Example'}}

```
Request URL:
http://NUXEO_SERVER/nuxeo/api/v1/id/4246ca87-c076-4bf4-b62b-0bab9dd21102
 Request Method: GET
 Request Headers
 ...
 Content-type: application/json
 enrichers.document: runningWorkflows
 properties: dublincore
```

{{/panel}}{{#> panel type='code' heading='JSON Response Example'}}

```
{
  "entity-type": "document",
  "repository": "default",
  "uid": "4246ca87-c076-4bf4-b62b-0bab9dd21102",
  "path": "/default-domain/workspaces/Marketing/photo.jpg",
  "type": "Picture",
  "state": "project",
  "parentRef": "036f99ec-a500-4a1e-9d89-e8eb656a0ff7",
  "isCheckedOut": true,
  "changeToken": "1426696491000",
  "title": "photo.jpg",
  "lastModified": "2015-03-18T16:34:51.00Z",
  "properties": {
    "dc:description": "",
    ...
  },
  "facets": [
    "Versionable",
    ...
  ],
  "contextParameters": {
    "runningWorkflows": [{
      "attachedDocumentIds": [{
        "id": "4246ca87-c076-4bf4-b62b-0bab9dd21102"
      }],
      "entity-type": "workflow",
      "graphResource": "http://NUXEO_SERVER/nuxeo/api/v1/workflow/75dfb9e0-65dd-4150-9d66-ade0597e27c2/graph",
      "id": "75dfb9e0-65dd-4150-9d66-ade0597e27c2",
      "initiator": "Administrator",
      "name": "ParallelDocumentReview.27323664461439033",
      "state": "running",
      "title": "wf.parallelDocumentReview.ParallelDocumentReview",
      "variables": {
        "end_date": "2016-05-27T22:00:00.00Z",
        "initiatorComment": null,
        "participants": [],
        "review_result": "",
        "review_result_file": {
          "data": "http://NUXEO_SERVER/nuxeo/nxfile/default/75dfb9e0-65dd-4150-9d66-ade0597e27c2/var_ParallelDocumentReview:review_result_file/output.ftl",
          "digest": "f5bd3d4fc1431be93631ecc3862a4ddc",
          "digestAlgorithm": "MD5",
          "encoding": null,
          "length": "68",
          "mime-type": "text/xml",
          "name": "output.ftl"
        },
        "validationOrReview": null
      },
      "workflowModelName": "ParallelDocumentReview"
    }]
  }
}
```

{{/panel}}

### {{> anchor 'runnableWorkflows'}}Runnable Workflows

{{#> panel type='code' heading='Call Example'}}

```
Request URL:
http://NUXEO_SERVER/nuxeo/api/v1/id/4246ca87-c076-4bf4-b62b-0bab9dd21102
 Request Method: GET
 Request Headers
 ...
 Content-type: application/json
 enrichers.document: runnableWorkflows
 properties: dublincore
```

{{/panel}}{{#> panel type='code' heading='JSON Response Example'}}

```
{
  "entity-type": "document",
  "repository": "default",
  "uid": "4246ca87-c076-4bf4-b62b-0bab9dd21102",
  "path": "/default-domain/workspaces/Marketing/photo.jpg",
  "type": "Picture",
  "state": "project",
  "parentRef": "036f99ec-a500-4a1e-9d89-e8eb656a0ff7",
  "isCheckedOut": true,
  "changeToken": "1426696491000",
  "title": "photo.jpg",
  "lastModified": "2015-03-18T16:34:51.00Z",
  "properties": {
    "dc:description": "",
    ...
  },
  "facets": [
    "Versionable",
    ...
  ],
  "contextParameters": {
    "runnableWorkflows": [{
      "attachedDocumentIds": [],
      "entity-type": "workflow",
      "graphResource": "http://NUXEO_SERVER/nuxeo/api/v1/workflowModel/SerialDocumentReview/graph",
      "id": "0b0a21b7-284c-4f69-99e6-c334f2c69077",
      "initiator": null,
      "name": "SerialDocumentReview",
      "state": "validated",
      "title": "wf.serialDocumentReview.SerialDocumentReview",
      "variables": {
        "index": 0,
        "initiatorComment": null,
        "participants": [],
        "validationOrReview": "validation"
      },
      "workflowModelName": "SerialDocumentReview"
    }]
  }
}
```

{{/panel}}

### Pending Tasks

{{#> panel type='code' heading='Call Example'}}

```
Request URL:
http://NUXEO_SERVER/nuxeo/api/v1/id/4246ca87-c076-4bf4-b62b-0bab9dd21102
 Request Method: GET
 Request Headers
 ...
 Content-type: application/json
 enrichers.document: pendingTasks
 properties: dublincore
```

{{/panel}}{{#> panel type='code' heading='JSON Response Example'}}

```
{
  "entity-type": "document",
  "repository": "default",
  "uid": "4246ca87-c076-4bf4-b62b-0bab9dd21102",
  "path": "/default-domain/workspaces/Marketing/photo.jpg",
  "type": "Picture",
  "state": "project",
  "parentRef": "036f99ec-a500-4a1e-9d89-e8eb656a0ff7",
  "isCheckedOut": true,
  "changeToken": "1426696491000",
  "title": "photo.jpg",
  "lastModified": "2015-03-18T16:34:51.00Z",
  "properties": {
    "dc:description": "",
    ...
  },
  "facets": [
    "Versionable",
    ...
  ],
  "contextParameters": {
    "pendingTasks": [{
      "actors": [{
        "id": "Administrator"
      }],
      "comments": [],
      "created": "2016-05-28T22:00:00.12Z",
      "directive": "wf.parallelDocumentReview.consolidate.directive",
      "dueDate": "2016-06-02T22:00:00.12Z",
      "entity-type": "task",
      "id": "18b6767a-990e-4d7d-870c-ba20494fe3b6",
      "name": "wf.parallelDocumentReview.consolidate.title",
      "nodeName": "Task2169",
      "state": "opened",
      "targetDocumentIds": [{
        "id": "d6b4be3e-e1e9-454b-812d-c156d1c2e96a"
      }],
      "taskInfo": {
        ...
      },
      "variables": {
        "assignees": [],
        "comment": null,
        "review_result": ""
      },
      "workflowInstanceId": "75dfb9e0-65dd-4150-9d66-ade0597e27c2",
      "workflowModelName": "ParallelDocumentReview"
    }]
  }
}
```

{{/panel}}

## Contributing Your Own Content Enricher

You can add your own content enricher by providing a Java class and a XML contribution. You can enrich a Nuxeo Document Model or any kind of specific object returned.

### Document Model Content Enricher

Here is a sample to get you started. It provides a document's parent ID, title and description.

{{! multiexcerpt name='enricher-contrib'}}

```xml
<?xml version="1.0" encoding="UTF-8"?>
    <component name="org.nuxeo.sample.enrichers.parentDocEnricher">
        <!-- Start copying here if you declare the enricher in Nuxeo Studio -->
        <extension target="org.nuxeo.ecm.core.io.MarshallerRegistry" point="marshallers">
            <register class="org.nuxeo.university.enrichers.ParentDocEnricher" enable="true" />
        </extension>
        <!-- Stop copying here if you declare the enricher in Nuxeo Studio -->
    </component>
```

{{! /multiexcerpt}}{{! multiexcerpt name='enricher-class'}}

```java
package org.nuxeo.sample.enrichers;

import static org.nuxeo.ecm.core.io.registry.reflect.Instantiations.SINGLETON;
import static org.nuxeo.ecm.core.io.registry.reflect.Priorities.REFERENCE;

import java.io.IOException;

import org.codehaus.jackson.JsonGenerator;
import org.codehaus.jackson.map.ObjectMapper;
import org.codehaus.jackson.node.ObjectNode;
import org.nuxeo.ecm.core.api.CoreSession;
import org.nuxeo.ecm.core.api.DocumentModel;

// The class is instantiated as a singleton
// Priority defines which marshaller is used in case of conflict. Priority is an integer.
// The higher the number, the higher the priority: 10 > 1 for instance.

@Setup(mode = SINGLETON, priority = REFERENCE)
public class ParentDocEnricher extends AbstractJsonEnricher<DocumentModel> {

// The enricher is called using enrichers.document: parentDoc
	public static final String NAME = "parentDoc";

    public ParentDocEnricher() {
        super(NAME);
    }

// Method that is called when the enricher is called
    @Override
    public void write(JsonGenerator jg, DocumentModel doc) throws IOException {
      ObjectNode parentDocJsonObject = addParentDocAsJson(doc);
      jg.writeFieldName(NAME);
      jg.writeObject(parentDocJsonObject);
    }

    private ObjectNode addParentDocAsJson(DocumentModel doc) {
      ObjectMapper o = new ObjectMapper();

      // First create the parent document's JSON object content
      CoreSession session = doc.getCoreSession();
      DocumentModel parentDoc = session.getDocument(doc.getParentRef());

      ObjectNode parentObject = o.createObjectNode();
      parentObject.put("id", parentDoc.getRef().toString());
      parentObject.put("title", parentDoc.getTitle());
      parentObject.put("description", parentDoc.getPropertyValue("dc:description").toString());

      return parentObject;
    }
}
```

{{! /multiexcerpt}}

### Specific Object Content Enricher

An example with a content enricher for the object `org.nuxeo.ecm.platform.audit.api.LogEntry`:

```xml
<?xml version="1.0" encoding="UTF-8"?>
    <component name="org.nuxeo.sample.enrichers.logEntryEnricher">
        <!-- Start copying here if you declare the enricher in Nuxeo Studio -->
        <extension target="org.nuxeo.ecm.core.io.MarshallerRegistry"
           point="marshallers">
           <register class="org.nuxeo.sample.enrichers.LogEntryEnricher" enable="true" />
        </extension>
        <!-- Stop copying here if you declare the enricher in Nuxeo Studio -->
    </component>
```

```java
package org.nuxeo.sample.enrichers;
import static org.nuxeo.ecm.core.io.registry.reflect.Instantiations.SINGLETON;
import static org.nuxeo.ecm.core.io.registry.reflect.Priorities.REFERENCE;

import java.io.IOException;
import java.text.SimpleDateFormat;
import java.util.Date;
import java.util.GregorianCalendar;

import org.codehaus.jackson.JsonGenerator;
import org.nuxeo.ecm.core.api.CoreInstance;
import org.nuxeo.ecm.core.api.CoreSession;
import org.nuxeo.ecm.core.api.DocumentModel;
import org.nuxeo.ecm.core.api.IdRef;
import org.nuxeo.ecm.core.api.NuxeoPrincipal;
import org.nuxeo.ecm.core.io.marshallers.json.enrichers.AbstractJsonEnricher;
import org.nuxeo.ecm.core.io.registry.reflect.Setup;
import org.nuxeo.ecm.platform.audit.api.LogEntry;
import org.nuxeo.ecm.platform.usermanager.UserManager;
import org.nuxeo.runtime.api.Framework;

import com.google.common.base.Strings;

@Setup(mode = SINGLETON, priority = REFERENCE)
public class LogEntryEnricher extends AbstractJsonEnricher<LogEntry> {

    public static final String NAME = "sfLogEntry";

    public LogEntryEnricher() {
        super(NAME);
    }

    @Override
    public void write(JsonGenerator jsonGenerator, LogEntry logEntry) throws IOException {
        CoreSession session = CoreInstance.openCoreSession(logEntry.getRepositoryId());
        DocumentModel targetDocument = session.getDocument(new IdRef(logEntry.getDocUUID()));
        Date creationDate = ((GregorianCalendar) targetDocument.getPropertyValue("dc:created")).getTime();
        Date modificationDate = ((GregorianCalendar) targetDocument.getPropertyValue("dc:modified")).getTime();

        jsonGenerator.writeObjectFieldStart(NAME);
        jsonGenerator.writeObjectField("contact", getPrincipalName(logEntry));
        jsonGenerator.writeObjectField("creation", new SimpleDateFormat("yyyy-MM-dd").format(creationDate));
        jsonGenerator.writeObjectField("modification", new SimpleDateFormat("yyyy-MM-dd").format(modificationDate));
        jsonGenerator.writeEndObject();
    }

    protected String getPrincipalName(LogEntry logEntry) {
        UserManager userManager = Framework.getService(UserManager.class);
        NuxeoPrincipal principal = userManager.getPrincipal(logEntry.getPrincipalName());
        String firstName = principal.getFirstName();
        String lastName = principal.getLastName();
        if (Strings.isNullOrEmpty(firstName) && Strings.isNullOrEmpty(lastName)) {
            return principal.getName();
        } else {
            return firstName + " " + lastName;
        }
    }
}
```

{{#> callout type='warning' heading='REST Request Header'}}

Don't forget to set the proper header to use this enricher:

`enrichers.logEntry = sfLogEntry`

{{/callout}}

{{#> panel type='code' heading='JSON Response Example'}}

```
{
  "entity-type": "document",
  "repository": "default",
  "uid": "4246ca87-c076-4bf4-b62b-0bab9dd21102",
  "path": "/default-domain/workspaces/Marketing/photo.jpg",
  "type": "Picture",
  "state": "project",
  "parentRef": "036f99ec-a500-4a1e-9d89-e8eb656a0ff7",
  "isCheckedOut": true,
  "changeToken": "1426696491000",
  "title": "photo.jpg",
  "lastModified": "2015-03-18T16:34:51.00Z",
  "properties": {
    "dc:description": "",
    ...
  },
  "facets": [
    "Versionable",
    ...
  ],
  "contextParameters": {
    "favorites": {
      "isFavorite": true
    }
  }
}
```

{{/panel}}

## Learn More

*   Watch the video [Using Content Enrichers](https://university.nuxeo.io/nuxeo/university/#!/course/working-with-nuxeo-platform-rest-api/using-content-enrichers) as part of the [REST API](https://university.nuxeo.io/nuxeo/university/#!/course/working-with-nuxeo-platform-rest-api) course at [Nuxeo University](https://university.nuxeo.io).
*   Use [Nuxeo CLI]({{page page='nuxeo-cli'}}) to bootstrap your Content Enricher.
*   Test these content enrichers on your local instance with [Nuxeo API Playground](http://nuxeo.github.io/api-playground/) (see [documentation]({{page version='' space='nxdoc' page='howto-nuxeo-api-playground'}}) to configure your local instance).
*   Checkout the Nuxeo REST API explorer of your instance at `http://NUXEO_SERVER/nuxeo/api/v1/doc`.
