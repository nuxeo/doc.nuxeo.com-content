---
title: Suggestion Widget Types
review:
    comment: ''
    date: '2017-01-23'
    status: ok
labels:
    - lts2016-ok
    - widget-types
    - atchertchian
    - select2
    - suggestion
    - excerpt
    - content-review-lts2017
    - jsf-ui
toc: true
confluence:
    ajs-parent-page-id: '3868345'
    ajs-parent-page-title: Standard Widget Types
    ajs-space-key: NXDOC
    ajs-space-name: Nuxeo Platform Developer Documentation
    canonical: Suggestion+Widget+Types
    canonical_source: 'https://doc.nuxeo.com/display/NXDOC/Suggestion+Widget+Types'
    page_id: '18449452'
    shortlink: LIQZAQ
    shortlink_source: 'https://doc.nuxeo.com/x/LIQZAQ'
    source_link: /display/NXDOC/Suggestion+Widget+Types
tree_item_index: 700
history:
    -
        author: Solen Guitter
        date: '2015-09-10 08:09'
        message: ''
        version: '44'
    -
        author: Solen Guitter
        date: '2015-08-31 14:19'
        message: Update table of contents look
        version: '43'
    -
        author: Bertrand Chauvin
        date: '2015-04-09 13:23'
        message: Reverted from v. 40
        version: '42'
    -
        author: Bertrand Chauvin
        date: '2015-04-09 13:22'
        message: ''
        version: '41'
    -
        author: Anahide Tchertchian
        date: '2014-01-29 10:19'
        message: ''
        version: '40'
    -
        author: Solen Guitter
        date: '2014-01-24 15:11'
        message: ''
        version: '39'
    -
        author: Solen Guitter
        date: '2014-01-24 15:09'
        message: Fixed link
        version: '38'
    -
        author: Solen Guitter
        date: '2014-01-24 15:08'
        message: ''
        version: '37'
    -
        author: Solen Guitter
        date: '2014-01-24 15:07'
        message: Fixed some links and formatting
        version: '36'
    -
        author: Guillaume Renard
        date: '2014-01-23 18:04'
        message: ''
        version: '35'
    -
        author: Guillaume Renard
        date: '2014-01-23 18:03'
        message: ''
        version: '34'
    -
        author: Guillaume Renard
        date: '2014-01-23 18:02'
        message: ''
        version: '33'
    -
        author: Anahide Tchertchian
        date: '2014-01-23 17:57'
        message: reorganize display
        version: '32'
    -
        author: Anahide Tchertchian
        date: '2014-01-23 17:53'
        message: wording/review
        version: '31'
    -
        author: Guillaume Renard
        date: '2014-01-23 12:07'
        message: ''
        version: '30'
    -
        author: Guillaume Renard
        date: '2014-01-23 12:06'
        message: ''
        version: '29'
    -
        author: Guillaume Renard
        date: '2014-01-23 12:04'
        message: ''
        version: '28'
    -
        author: Guillaume Renard
        date: '2014-01-23 12:00'
        message: ''
        version: '27'
    -
        author: Guillaume Renard
        date: '2014-01-22 18:16'
        message: ''
        version: '26'
    -
        author: Guillaume Renard
        date: '2014-01-22 17:42'
        message: ''
        version: '25'
    -
        author: Guillaume Renard
        date: '2014-01-22 17:28'
        message: ''
        version: '24'
    -
        author: Guillaume Renard
        date: '2014-01-22 15:43'
        message: ''
        version: '23'
    -
        author: Guillaume Renard
        date: '2014-01-22 15:27'
        message: ''
        version: '22'
    -
        author: Guillaume Renard
        date: '2014-01-22 14:19'
        message: ''
        version: '21'
    -
        author: Guillaume Renard
        date: '2014-01-22 14:16'
        message: ''
        version: '20'
    -
        author: Guillaume Renard
        date: '2014-01-22 14:15'
        message: ''
        version: '19'
    -
        author: Guillaume Renard
        date: '2014-01-22 13:54'
        message: ''
        version: '18'
    -
        author: Guillaume Renard
        date: '2014-01-22 13:46'
        message: ''
        version: '17'
    -
        author: Guillaume Renard
        date: '2014-01-22 12:30'
        message: ''
        version: '16'
    -
        author: Guillaume Renard
        date: '2014-01-22 12:24'
        message: ''
        version: '15'
    -
        author: Guillaume Renard
        date: '2014-01-22 12:10'
        message: ''
        version: '14'
    -
        author: Guillaume Renard
        date: '2014-01-22 11:26'
        message: ''
        version: '13'
    -
        author: Guillaume Renard
        date: '2014-01-22 10:59'
        message: ''
        version: '12'
    -
        author: Guillaume Renard
        date: '2014-01-22 10:53'
        message: ''
        version: '11'
    -
        author: Guillaume Renard
        date: '2014-01-21 20:01'
        message: ''
        version: '10'
    -
        author: Guillaume Renard
        date: '2014-01-21 19:53'
        message: ''
        version: '9'
    -
        author: Guillaume Renard
        date: '2014-01-21 19:51'
        message: ''
        version: '8'
    -
        author: Guillaume Renard
        date: '2014-01-21 19:51'
        message: ''
        version: '7'
    -
        author: Guillaume Renard
        date: '2014-01-21 15:42'
        message: ''
        version: '6'
    -
        author: Guillaume Renard
        date: '2014-01-21 15:40'
        message: ''
        version: '5'
    -
        author: Guillaume Renard
        date: '2014-01-21 15:20'
        message: ''
        version: '4'
    -
        author: Guillaume Renard
        date: '2014-01-21 14:58'
        message: ''
        version: '3'
    -
        author: Guillaume Renard
        date: '2014-01-21 10:57'
        message: ''
        version: '2'
    -
        author: Guillaume Renard
        date: '2014-01-21 10:57'
        message: ''
        version: '1'

---
{{{multiexcerpt 'JSF-UI-required' page='generic-multi-excerpts'}}}
{{! excerpt}}
A series of widget types for suggestions.
{{! /excerpt}}

Since 5.7.2, Nuxeo uses [select2](http://select2.github.io/select2/) for the suggestion widgets:

*   the user suggestion and the document suggestion widgets were previously based on the RichFaces suggestion box, and they now use select2;
*   a new directory suggestion widget is provided.

Unlike the older JSF suggestion widgets, these select2-based widgets rely upon an [automation]({{page page='content-automation-concepts'}}) operation to retrieve suggestions according to the search term typed in the select2 box. The backing operation returns suggestions as an array of JSON objects that select2 is able to manipulate.

As a result, it is quite easy to [customize the display](#customdisplay) of selected/suggested entries.

Also, these suggestion widgets can be used inside lists (older suggestion widgets had [limitations]({{page page='default-widget-types-known-limitations'}})).

## {{> anchor 'widgettypes'}}The Different Types of Widgets

Each widget type is available for single and multiple suggestions.

### {{> anchor 'directory'}}Directory Suggestion Widget Type

This widget type lets the user select an entry among a list of vocabulary entries, based on the user input. Widget type names are:

*   suggestOneDirectory
*   suggestManyDirectory

![l10ncoverage suggestion widget]({{file name='docdirectorySuggestion.png'}} ?w=400,border=true 'l10ncoverage suggestion widget')

_**Picture 1:** `suggestOneDirectory` presenting l10ncoverage vocabulary. Countries are grouped by continent._

These new widgets come in addition to the existing selectOneDirectory and selectManyDirectory. The suggestion are provided by the [`SuggestDirectoryEntries`](https://github.com/nuxeo/nuxeo-features/blob/master/nuxeo-platform-ui-select2/src/main/java/org/nuxeo/ecm/platform/ui/select2/automation/SuggestDirectoryEntries.java) operation.

Suggestion widgets can present multi-level chained vocabulary out of the box. A multi-level chained vocabulary is a vocabulary whose entries have a parent entry such as ln10coverage and ln10subjects. These widgets will be able to group entries by their parents only if the parent is also defined in the vocabulary.

#### About Label Localization

By default, suggestion widgets assume the vocabulary labels are not localized. In case of need of localization, these widgets support two ways of label localization:

###### Properties File Translation

The translations are available is `message_xx.properties` files and the vocabulary only handles the label key. As of Nuxeo 5.8, labels will be translated if the widget is marked as translated in its configuration (but this should be tied to the "localize" property for better consistency so this will likely change in the future, see [NXP-13629](https://jira.nuxeo.com/browse/NXP-13629)):


```xml
<translated>true</translated>
```

###### Column-Based Translation

The vocabulary handles as many label columns as supported locales. Again this is the case for ln10coverage and ln10subjects which have two columns for English and French translations. To support such vocabulary structure, the `dbl10n` widget property must be set to true:

```xml
<property name="dbl10n">true</property>
```

By convention, the field name associated to these label columns must respect the pattern **label_xx** where xx is the locale code. However this can be changed with the `labelFieldName` widget parameter. For instance, the following configuration means that labels are translated using the columns `language_en`, `language_fr`, etc. of your vocabulary.

```xml
<property name="labelFieldName">language_{lang}</property>
```

{{#> callout type='tip' }}

Using column-based translation allows to directly query suggestions in the directory associated to the vocabulary. This is much more efficient than filtering on translations handled by properties file in term of performance.

{{/callout}}

Check out the layout showcase for more details on available widget properties:

*   [Vocabulary suggestion showcase](http://showcase.nuxeo.com/nuxeo/layoutDemo/suggest_one_directory_widget/reference)
*   [Multiple vocabulary showcase](http://showcase.nuxeo.com/nuxeo/layoutDemo/suggest_one_directory_multiple_widget/reference)

### {{> anchor 'user'}}User Suggestion Widget Type

This widget type lets the user select an entry among a list of users or groups based on the user input. Widget type names are:

*   singleUserSuggestion
*   multipleUsersSuggestion

![]({{file name='docuserSuggestion.png'}} ?w=400,border=true)

_**Picture 2:** multipleUsersSuggestion_

Previously based on RichFaces suggestion box in Nuxeo Platform 5.6 and earlier versions, these widgets now use select2 to present user suggestions returned by the [`SuggestUserEntries`](https://github.com/nuxeo/nuxeo-features/blob/master/nuxeo-platform-ui-select2/src/main/java/org/nuxeo/ecm/platform/ui/select2/automation/SuggestUserEntries.java) operation. All previous widget properties are still available.

However, here are noticeable new properties:

###### groupRestriction

This property allows to specify a group id to restrict the suggested users.

Check out the layout showcase for more details on available widget properties:

*   [Single user showcase](http://showcase.nuxeo.com/nuxeo/layoutDemo/singleUserSuggestion/reference)
*   [Multiple user showcase](http://showcase.nuxeo.com/nuxeo/layoutDemo/multipleUsersSuggestion/reference)

### {{> anchor 'document'}}Document Suggestion Widget Type

This widget type lets the user select an entry among a list of existing documents of the repository that results from a search query based on the user input. Widget type names are:

*   singleDocumentSuggestion
*   multipleDocumentsSuggestion

![]({{file name='docdocumentSuggestion.png'}} ?w=400,border=true)

_**{{> anchor 'picture3'}}Picture 3:** singleDocumentSuggestion_

Previously based on RichFaces suggestion box for Nuxeo Platform 5.6 and earlier versions, these suggestion widgets now use select2 to present document suggestions returned by the  [`DocumentPageProviderOperation`](https://github.com/nuxeo/nuxeo-features/blob/master/nuxeo-automation/nuxeo-automation-features/src/main/java/org/nuxeo/ecm/automation/core/operations/services/DocumentPageProviderOperation.java) operation.

##### Modifying the Way of Suggesting Documents

This operation uses the [`default_document_suggestion`](http://explorer.nuxeo.org/nuxeo/site/distribution/latest/viewContribution/org.nuxeo.ecm.webapp.pageproviders.contrib--providers) page provider. However, you can specify the NXQL query to be executed via the widget property named `query`.

{{#> panel type='code' heading='Query to suggest documents with title starting with the entered term'}}

```xml
<property name="query">
  SELECT * FROM  Document WHERE dc:title LIKE ? AND ecm:mixinType != 'HiddenInNavigation' AND ecm:isVersion = 0 AND ecm:isTrashed = 0
</property>
```

{{/panel}}

The specified query must have one parameter (the '?' character in the query above). This parameter will be be valued with the term entered in the select2\. Note that a '%' character will be automatically appended to the entered value.

Finally, it is also possible to tell these widgets to use another page provider with the widget property `pageProviderName`. See the pages [Custom Page Providers]({{page page='custom-page-providers'}}) and [Page Providers]({{page page='page-providers'}}).

##### Which Document Properties Are Accessible?

As explained above, the [DocumentPageProviderOperation](https://github.com/nuxeo/nuxeo-features/blob/master/nuxeo-automation/nuxeo-automation-features/src/main/java/org/nuxeo/ecm/automation/core/operations/services/DocumentPageProviderOperation.java) will return documents serialized as JSON objects. By default, the properties of the `dublincore` and `common` schemas are serialized. However, you can extend the list of schemas that must be returned in the document JSON serialization with the `documentSchemas` widget property:

```xml
<property name="documentSchemas">dublincore,common</property>
```

This is useful if you need to [customize the display of the suggested/selected entries](#customdisplay) with specific document properties.

### {{> anchor 'advanced'}}Advanced Suggestion Widget Type

*   select2Widget
*   select2WidgetMultiple

{{#> callout type='note' }}

This section deals with advanced settings and requires some development skills.

{{/callout}}

In case you'd like to build your own advanced suggestion widget, here are additional widget properties.

###### operationId

Specify the id of an automation operation that will be used to feed the widget with suggestion.

```xml
<property name"operationId">your_operation_id</property>
```

The term entered in select2 will be passed to the specified operation under the parameter `searchTerm`. Your operation must therefore at least have this parameter:

```java
@Param(name = "searchTerm", required = false)
protected String searchTerm;
```

The specified operation must return an array of JSON objects which, to be interpreted by select2, must contains the following elements:

*   `id`: the value or reference to be submitted (i.e. saved in the bound field). In case of a JSON serialization of a document, it is the document uid. However, you can modify which element of the JSON object must be submitted with the `idProperty` widget property.

*   `displayLabel`: the label to displayed by select2 in the UI. However, if you use [custom formatter](#customdisplay), it will be ignored.

## {{> anchor 'customdisplay'}}Custom Display

### How to Format the Displayed Entries

Suggestion widget appearance can be customized in a quite flexible way through the use of JavaScript formatters. You can separately tune the formatting of both the suggested and selected entries. All suggestion widgets have the following widget properties:

*   `suggestionFormatter`
*   `selectionFormatter`
*   `inlinejs`

As explained above, each suggested entries are JSON objects returned by an automation operation. The idea is to define a JavaScript function that will generate the HTML to render this JSON object. For instance, the formatter used to render suggested documents in the above [Picture 3](#picture3) is:

{{#> panel type='code' heading='Example of formatter used in Picture 3'}}

```js
  function myDocFormatter(doc) {
    var markup = "<table><tbody>";
    markup += "<tr><td>";
    if (doc.properties && doc.properties['common:icon']) {
      markup += "<img src='" + window.nxContextPath
          + doc.properties['common:icon'] + "'/>"
    }
    markup += "</td><td>";
    markup += doc.title;
    if (doc.warn_message) {
      markup += "<img src='" + window.nxContextPath
          + "/icons/warning.gif' title='" + doc.warn_message + "'/>"
    }
    if (doc.path) {
      markup += "<span class='displayB detail' style='word-break:break-all;'>" + doc.path + "</span>";
    }
    markup += "</td></tr></tbody></table>"
    return markup;
  }
```

{{/panel}}

You can define the JS code of your custom formatters directly in the inlinejs widget property, it will be injected in the rendered HTML page. Alternatively, you can define your formatters as global JavaScript resources by contributing them to the [Theme]({{page page='theme'}}).

Once you have defined a custom formatter, you can tell your widgets to use it:

```xml
<property name="suggestionFormatter">myformatter</property>
<property name="selectionFormatter">myformatter</property>
<property name="inlinejs">

      function myformatter(doc) {
        return doc.title;
      }
   ]]>
</property>
```

{{#> callout type='info' }}

The JSON serialization of documents is not flat! Here is how you can access the document properties, for instance, based on the snippet above (line 4):

```
doc.properties['common:icon']
```

{{/callout}}

![]({{file name='custom_formatter.png'}} ?w=400,border=true)

_**Picture 4:** multipleDocumentsSuggestion with custom formatter to suggest documents with "Picture" facet. See this [cookbook]({{page page='tutorials'}}) for more information._

### How to Customize CSS Styling

You can finally customize the CSS style of the select2-based widgets through the use of the following widget properties:

*   `containerCssClass`
*   `dropdownCssClass`

The container is the div handling the current selection and the dropdown is the popup box suggesting available entries.

These properties are passed through to select2, that handles these properties as standard select2 parameters. Please refer to the [select2 documentation](http://select2.github.io/select2/) for more details about these parameters.

Finally you can specify the `width` property, it accepts pixel as well as percentage (i.e. 300px and 100%).

## {{> anchor 'internationalization'}}Internationalization

Select2 widgets localization is provided by the select2 library and the control labels are therefore not translated in `messages_xx.properties` files but directly in [select2 resources files](https://github.com/nuxeo-archives/nuxeo-features/tree/master/nuxeo-platform-ui-select2/src/main/resources/META-INF/resources/org.nuxeo.select2). Many locales are provided.

However, if you're a missing a locale, you must create your own `select2_locale_xx.js` file and add it to your own bundle. This file must be deployed in `${NUXEO_HOME}/nxserver/nuxeo.war/scripts/select2/` directory.
